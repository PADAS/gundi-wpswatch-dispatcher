import datetime
import pytest
import asyncio
import gundi_core.schemas.v2 as schemas_v2
from smartconnect import SMARTClientException
from gundi_core import events as system_events
from gcloud.aio import pubsub
from app.core import settings


def async_return(result):
    f = asyncio.Future()
    f.set_result(result)
    return f


@pytest.fixture
def mock_cache(mocker):
    mock_cache = mocker.MagicMock()
    mock_cache.get.return_value = async_return(None)
    mock_cache.setex.return_value = async_return(None)
    mock_cache.incr.return_value = mock_cache
    mock_cache.decr.return_value = async_return(None)
    mock_cache.expire.return_value = mock_cache
    mock_cache.execute.return_value = async_return((1, True))
    mock_cache.__aenter__.return_value = mock_cache
    mock_cache.__aexit__.return_value = None
    mock_cache.pipeline.return_value = mock_cache
    return mock_cache


@pytest.fixture
def mock_cache_with_rate_limit_exceeded(mock_cache):
    mock_cache.execute.return_value = async_return(
        (4, True)
    )  # 3 req/sec is the default limit
    return mock_cache


@pytest.fixture
def observation_delivered_pubsub_message():
    return pubsub.PubsubMessage(
        b'{"event_id": "c05cf942-f543-4798-bd91-0e38a63d655e", "timestamp": "2023-07-12 20:34:07.210731+00:00", "schema_version": "v1", "payload": {"gundi_id": "23ca4b15-18b6-4cf4-9da6-36dd69c6f638", "related_to": "None", "external_id": "7f42ab47-fa7a-4a7e-acc6-cadcaa114646", "data_provider_id": "ddd0946d-15b0-4308-b93d-e0470b6d33b6", "destination_id": "338225f3-91f9-4fe1-b013-353a229ce504", "delivered_at": "2023-07-12 20:34:07.210542+00:00"}, "event_type": "ObservationDelivered"}'
    )


@pytest.fixture
def observation_delivery_failure_pubsub_message():
    return pubsub.PubsubMessage(
        b'{"event_id": "61e9c40b-60c2-4279-abeb-c918dc5d6442", "timestamp": "2024-01-08 19:51:42.750821+00:00", "schema_version": "v1", "payload": {"gundi_id": "3a09e9c8-525a-4431-a43e-12a9830f688e", "related_to": "None", "external_id": null, "data_provider_id": "d88ac520-2bf6-4e6b-ab09-38ed1ec6947a", "destination_id": "b42c9205-5228-49e0-a75b-ebe5b6a9f78e", "delivered_at": "2024-01-08 19:51:42.750646+00:00"}, "event_type": "ObservationDeliveryFailed"}'
    )


@pytest.fixture
def mock_pubsub_client(
    mocker, observation_delivered_pubsub_message, gcp_pubsub_publish_response
):
    mock_client = mocker.MagicMock()
    mock_publisher = mocker.MagicMock()
    mock_publisher.publish.return_value = async_return(gcp_pubsub_publish_response)
    mock_publisher.topic_path.return_value = (
        f"projects/{settings.GCP_PROJECT_ID}/topics/{settings.DISPATCHER_EVENTS_TOPIC}"
    )
    mock_client.PublisherClient.return_value = mock_publisher
    mock_client.PubsubMessage.return_value = observation_delivered_pubsub_message
    return mock_client


@pytest.fixture
def mock_pubsub_client_with_observation_delivery_failure(
    mocker, observation_delivery_failure_pubsub_message, gcp_pubsub_publish_response
):
    mock_client = mocker.MagicMock()
    mock_publisher = mocker.MagicMock()
    mock_publisher.publish.return_value = async_return(gcp_pubsub_publish_response)
    mock_publisher.topic_path.return_value = (
        f"projects/{settings.GCP_PROJECT_ID}/topics/{settings.DISPATCHER_EVENTS_TOPIC}"
    )
    mock_client.PublisherClient.return_value = mock_publisher
    mock_client.PubsubMessage.return_value = observation_delivery_failure_pubsub_message
    return mock_client


@pytest.fixture
def post_report_response():
    return {}


@pytest.fixture
def smartclient_post_smart_request_response():
    return {}


@pytest.fixture
def gcp_pubsub_publish_response():
    return {"messageIds": ["7061707768812258"]}


@pytest.fixture
def inbound_integration_config():
    return {
        "state": {},
        "id": "12345b4f-88cd-49c4-a723-0ddff1f580c4",
        "type": "1234e5bd-a473-4c02-9227-27b6134615a4",
        "owner": "1234191a-bcf3-471b-9e7d-6ba8bc71be9e",
        "endpoint": "https://test.gfw.org",
        "login": "test",
        "password": "test",  # pragma: allowlist secret
        "token": "",
        "type_slug": "gfw",
        "provider": "gfw",
        "default_devicegroup": "1234cfdc-1aae-44b0-8e0a-22c72355ea85",
        "enabled": True,
        "name": "GFW - SMART Connect",
    }


@pytest.fixture
def outbound_integration_config():
    return {
        "id": "38ebbae6-2535-43f9-be88-96f9daec83f3",
        "type": "f61b0c60-c863-44d7-adc6-d9b49b389e69",
        "owner": "1111191a-bcf3-471b-9e7d-6ba8bc71be9e",
        "name": "[Internal] AI2 Test -  GFW to  SMART Connect",
        "endpoint": "https://fakesmartconnectsite.smartconservationtools.org/server",
        "state": {},
        "login": "",
        "password": "",
        "token": "faked87681cd1d01ad07c2d0f57d15d6079ae7d7",  # pragma: allowlist secret
        "type_slug": "smart_connect",
        "inbound_type_slug": "gfw",
        "additional": {},
    }


@pytest.fixture
def mock_gundi_client_v1(
    mocker,
    inbound_integration_config,
    outbound_integration_config,
):
    mock_client = mocker.MagicMock()
    mock_client.get_inbound_integration.return_value = async_return(
        inbound_integration_config
    )
    mock_client.get_outbound_integration.return_value = async_return(
        outbound_integration_config
    )
    return mock_client


@pytest.fixture
def mock_gundi_client_v2(
    mocker,
    smart_integration_v2,
):
    mock_client = mocker.MagicMock()
    mock_client.get_integration_details.return_value = async_return(
        smart_integration_v2
    )
    mock_client.__aenter__.return_value = mock_client
    mock_client.__aexit__.return_value = None
    return mock_client


@pytest.fixture
def mock_gundi_client_v2_class(mocker, mock_gundi_client_v2):
    mock_gundi_client_v2_class = mocker.MagicMock()
    mock_gundi_client_v2_class.return_value = mock_gundi_client_v2
    return mock_gundi_client_v2_class


@pytest.fixture
def geoevent_v2_cloud_event_payload():
    timestamp = datetime.datetime.now().strftime("%Y-%m-%dT%H:%M:%S.%fZ")
    return {
        "message": {
            "attributes": {
                "annotations": "{}",
                "data_provider_id": "88ac5e9c-a3f0-47ff-9382-58d0abfa95f3",
                "destination_id": "58c44611-e356-4e4d-82bb-26f50f1fc1e8",
                "external_source_id": "default-source",
                "gundi_id": "44eaf798-fa87-48d9-9baf-42dfdb4c6231",
                "gundi_version": "v2",
                "provider_key": "gundi_cellstop_88ac5e9c-a3f0-47ff-9382-58d0abfa95f3",
                "related_to": "",
                "source_id": "e702598d-42d0-4094-8d1e-856caca4926e",
                "stream_type": "ev",
                "tracing_context": "{}",
            },
            "data": "eyJjYV91dWlkIjogIjRiMjMyNDJhLTExNjEtNDZjMy1hZjg0LTVlMzVkYzgwMWM0MyIsICJwYXRyb2xfcmVxdWVzdHMiOiBbXSwgIndheXBvaW50X3JlcXVlc3RzIjogW3sidHlwZSI6ICJGZWF0dXJlIiwgImdlb21ldHJ5IjogeyJjb29yZGluYXRlcyI6IFstNzIuNzA0NDI1LCAtNTEuNjg4NjQ1XX0sICJwcm9wZXJ0aWVzIjogeyJkYXRlVGltZSI6ICIyMDI0LTAxLTA4VDA5OjUxOjE0IiwgInNtYXJ0RGF0YVR5cGUiOiAiaW5jaWRlbnQiLCAic21hcnRGZWF0dXJlVHlwZSI6ICJ3YXlwb2ludC9uZXciLCAic21hcnRBdHRyaWJ1dGVzIjogeyJvYnNlcnZhdGlvbkdyb3VwcyI6IFt7Im9ic2VydmF0aW9ucyI6IFt7Im9ic2VydmF0aW9uVXVpZCI6ICI0NGVhZjc5OC1mYTg3LTQ4ZDktOWJhZi00MmRmZGI0YzYyMzEiLCAiY2F0ZWdvcnkiOiAiYW5pbWFscy5zaWduIiwgImF0dHJpYnV0ZXMiOiB7InNwZWNpZXMiOiAibGlvbiJ9fV19XSwgInBhdHJvbFV1aWQiOiBudWxsLCAicGF0cm9sTGVnVXVpZCI6IG51bGwsICJwYXRyb2xJZCI6IG51bGwsICJpbmNpZGVudElkIjogImd1bmRpX2V2XzQ0ZWFmNzk4LWZhODctNDhkOS05YmFmLTQyZGZkYjRjNjIzMSIsICJpbmNpZGVudFV1aWQiOiAiNDRlYWY3OTgtZmE4Ny00OGQ5LTliYWYtNDJkZmRiNGM2MjMxIiwgInRlYW0iOiBudWxsLCAib2JqZWN0aXZlIjogbnVsbCwgImNvbW1lbnQiOiAiUmVwb3J0OiBBbmltYWxzIFNpZ25cbkltcG9ydGVkOiAyMDI0LTAxLTA4VDEwOjQwOjU5LjU4MzE4MC0wMzowMCIsICJpc0FybWVkIjogbnVsbCwgInRyYW5zcG9ydFR5cGUiOiBudWxsLCAibWFuZGF0ZSI6IG51bGwsICJudW1iZXIiOiBudWxsLCAibWVtYmVycyI6IG51bGwsICJsZWFkZXIiOiBudWxsLCAiYXR0YWNobWVudHMiOiBudWxsfX19XSwgInRyYWNrX3BvaW50X3JlcXVlc3RzIjogW119",  # pragma: allowlist secret
            "messageId": "9155786613739819",
            "message_id": "9155786613739819",
            "publishTime": timestamp,
            "publish_time": timestamp,
        },
        "subscription": "projects/cdip-stage-78ca/subscriptions/eventarc-us-central1-smart-dispatcher-topic-test-trigger-1zb7crbq-sub-909",
    }


@pytest.fixture
def pubsub_cloud_event_headers():
    timestamp = datetime.datetime.now().strftime("%Y-%m-%dT%H:%M:%S.%fZ")
    return {
        "host": "smart-dispatcher-jabcutl7za-uc.a.run.app",
        "content-type": "application/json",
        "authorization": "Bearer fake-token",
        "content-length": "2057",
        "accept": "application/json",
        "from": "noreply@google.com",
        "user-agent": "APIs-Google; (+https://developers.google.com/webmasters/APIs-Google.html)",
        "x-cloud-trace-context": "",
        "traceparent": "",
        "x-forwarded-for": "64.233.172.137",
        "x-forwarded-proto": "https",
        "forwarded": 'for="64.233.172.137";proto=https',
        "accept-encoding": "gzip, deflate, br",
        "ce-id": "10090163454824831",
        "ce-source": "//pubsub.googleapis.com/projects/cdip-stage-78ca/topics/smart-dispatcher-topic-test",
        "ce-specversion": "1.0",
        "ce-type": "google.cloud.pubsub.topic.v1.messagePublished",
        "ce-time": timestamp,
    }


@pytest.fixture
def er_patrol_v1_cloud_event_payload():
    timestamp = datetime.datetime.now().strftime("%Y-%m-%dT%H:%M:%S.%fZ")
    return {
        "message": {
            "attributes": {
                "observation_type": "er_patrol",
                "device_id": "9feb3205-26d2-467b-8c82-dbefa65f2a33",
                "outbound_config_id": "38ebbae6-2535-43f9-be88-96f9daec83f3",
                "integration_id": "c25a53f6-e206-43dd-8f62-a3759565ae3d",
                "tracing_context": "{}",
            },
            "data": "eyJjYV91dWlkIjogIjE2OTM2MWQwLTYyYjgtNDExZC1hOGU2LTAxOTgyMzgwNTAxNiIsICJwYXRyb2xfcmVxdWVzdHMiOiBbeyJ0eXBlIjogIkZlYXR1cmUiLCAiZ2VvbWV0cnkiOiB7ImNvb3JkaW5hdGVzIjogWy0xMDMuNDQ0NTAzMSwgMjAuNjg3NTI0NF19LCAicHJvcGVydGllcyI6IHsiZGF0ZVRpbWUiOiAiMjAyNC0wMi0xOVQxMDoxODo1NyIsICJzbWFydERhdGFUeXBlIjogInBhdHJvbCIsICJzbWFydEZlYXR1cmVUeXBlIjogInBhdHJvbC9uZXciLCAic21hcnRBdHRyaWJ1dGVzIjogeyJvYnNlcnZhdGlvbkdyb3VwcyI6IG51bGwsICJwYXRyb2xVdWlkIjogIjlmZWIzMjA1LTI2ZDItNDY3Yi04YzgyLWRiZWZhNjVmMmEzMyIsICJwYXRyb2xMZWdVdWlkIjogImE5OGE2YjBmLWY1NTUtNDQzYi05YmNmLTAxZDcyMTQ1MTM1OCIsICJwYXRyb2xJZCI6ICJFUi0xOSIsICJpbmNpZGVudElkIjogbnVsbCwgImluY2lkZW50VXVpZCI6IG51bGwsICJ0ZWFtIjogImNvbW11bml0eXRlYW0xIiwgIm9iamVjdGl2ZSI6IG51bGwsICJjb21tZW50IjogIlxuSW1wb3J0ZWQ6IDIwMjQtMDItMTlUMTA6MjE6NDYuMDk0NzYxLTA2OjAwIiwgImlzQXJtZWQiOiAiZmFsc2UiLCAidHJhbnNwb3J0VHlwZSI6ICJmb290IiwgIm1hbmRhdGUiOiAiZm9sbG93dXAiLCAibnVtYmVyIjogbnVsbCwgIm1lbWJlcnMiOiBbIjViNGI2ODYyODEzMzQ1NzA4NjUyNDFlNTI5ZWZhY2ZhIl0sICJsZWFkZXIiOiAiNWI0YjY4NjI4MTMzNDU3MDg2NTI0MWU1MjllZmFjZmEiLCAiYXR0YWNobWVudHMiOiBudWxsfX19XSwgIndheXBvaW50X3JlcXVlc3RzIjogW3sidHlwZSI6ICJGZWF0dXJlIiwgImdlb21ldHJ5IjogeyJjb29yZGluYXRlcyI6IFstMTAzLjQ0NDUxNzcsIDIwLjY4NzUyNDZdfSwgInByb3BlcnRpZXMiOiB7ImRhdGVUaW1lIjogIjIwMjQtMDItMTlUMTA6MTk6MzYiLCAic21hcnREYXRhVHlwZSI6ICJwYXRyb2wiLCAic21hcnRGZWF0dXJlVHlwZSI6ICJ3YXlwb2ludC9uZXciLCAic21hcnRBdHRyaWJ1dGVzIjogeyJvYnNlcnZhdGlvbkdyb3VwcyI6IFt7Im9ic2VydmF0aW9ucyI6IFt7Im9ic2VydmF0aW9uVXVpZCI6ICJlNGQxMWI2MS0yNjNhLTQ0M2QtOGM3ZC1iOGNhNWI1NDNjNGQiLCAiY2F0ZWdvcnkiOiAiaHVtYW5hY3Rpdml0eS50aW1iZXJvYnNlcnZhdGlvbiIsICJhdHRyaWJ1dGVzIjogeyJ2b2x1bWVtMyI6IDEsICJudW1iZXJvZnRpbWJlciI6IDEsICJ0aW1iZXJ0cmVlc3BlY2llcyI6ICJjbGFzczEuY2hoZWtyYW0ifX1dfV0sICJwYXRyb2xVdWlkIjogIjlmZWIzMjA1LTI2ZDItNDY3Yi04YzgyLWRiZWZhNjVmMmEzMyIsICJwYXRyb2xMZWdVdWlkIjogImE5OGE2YjBmLWY1NTUtNDQzYi05YmNmLTAxZDcyMTQ1MTM1OCIsICJwYXRyb2xJZCI6IG51bGwsICJpbmNpZGVudElkIjogIkVSLTQ5NTUzIiwgImluY2lkZW50VXVpZCI6ICJlNGQxMWI2MS0yNjNhLTQ0M2QtOGM3ZC1iOGNhNWI1NDNjNGQiLCAidGVhbSI6IG51bGwsICJvYmplY3RpdmUiOiBudWxsLCAiY29tbWVudCI6ICJSZXBvcnQ6IGh1bWFuYWN0aXZpdHlfdGltYmVyb2JzZXJ2YXRpb25cbkltcG9ydGVkOiAyMDI0LTAyLTE5VDEwOjIxOjQ2LjA5Nzc4Ni0wNjowMCIsICJpc0FybWVkIjogbnVsbCwgInRyYW5zcG9ydFR5cGUiOiBudWxsLCAibWFuZGF0ZSI6IG51bGwsICJudW1iZXIiOiBudWxsLCAibWVtYmVycyI6IG51bGwsICJsZWFkZXIiOiBudWxsLCAiYXR0YWNobWVudHMiOiBbXX19fSwgeyJ0eXBlIjogIkZlYXR1cmUiLCAiZ2VvbWV0cnkiOiB7ImNvb3JkaW5hdGVzIjogWy0xMDMuNDQ0NTE3NywgMjAuNjg3NTI0Nl19LCAicHJvcGVydGllcyI6IHsiZGF0ZVRpbWUiOiAiMjAyNC0wMi0xOVQxMDoyMDoxMiIsICJzbWFydERhdGFUeXBlIjogInBhdHJvbCIsICJzbWFydEZlYXR1cmVUeXBlIjogIndheXBvaW50L25ldyIsICJzbWFydEF0dHJpYnV0ZXMiOiB7Im9ic2VydmF0aW9uR3JvdXBzIjogW3sib2JzZXJ2YXRpb25zIjogW3sib2JzZXJ2YXRpb25VdWlkIjogIjU5Y2FkMmMxLWE5MzktNDk2YS05YzFmLTcwYWQ5MTUzZTcxOCIsICJjYXRlZ29yeSI6ICJodW1hbmFjdGl2aXR5LnRpbWJlcm9ic2VydmF0aW9uIiwgImF0dHJpYnV0ZXMiOiB7Im51bWJlcm9mdGltYmVyIjogMSwgInRpbWJlcnRyZWVzcGVjaWVzIjogImNsYXNzMS5kb3VuZ2NoYWVtIn19XX1dLCAicGF0cm9sVXVpZCI6ICI5ZmViMzIwNS0yNmQyLTQ2N2ItOGM4Mi1kYmVmYTY1ZjJhMzMiLCAicGF0cm9sTGVnVXVpZCI6ICJhOThhNmIwZi1mNTU1LTQ0M2ItOWJjZi0wMWQ3MjE0NTEzNTgiLCAicGF0cm9sSWQiOiBudWxsLCAiaW5jaWRlbnRJZCI6ICJFUi00OTU1NCIsICJpbmNpZGVudFV1aWQiOiAiNTljYWQyYzEtYTkzOS00OTZhLTljMWYtNzBhZDkxNTNlNzE4IiwgInRlYW0iOiBudWxsLCAib2JqZWN0aXZlIjogbnVsbCwgImNvbW1lbnQiOiAiUmVwb3J0OiBodW1hbmFjdGl2aXR5X3RpbWJlcm9ic2VydmF0aW9uXG5JbXBvcnRlZDogMjAyNC0wMi0xOVQxMDoyMTo0Ni4wOTkyODktMDY6MDAiLCAiaXNBcm1lZCI6IG51bGwsICJ0cmFuc3BvcnRUeXBlIjogbnVsbCwgIm1hbmRhdGUiOiBudWxsLCAibnVtYmVyIjogbnVsbCwgIm1lbWJlcnMiOiBudWxsLCAibGVhZGVyIjogbnVsbCwgImF0dGFjaG1lbnRzIjogW119fX1dLCAidHJhY2tfcG9pbnRfcmVxdWVzdHMiOiBbXX0=",  # pragma: allowlist secret
            "messageId": "9155786613739819",
            "message_id": "9155786613739819",
            "publishTime": timestamp,
            "publish_time": timestamp,
        },
        "subscription": "projects/cdip-stage-78ca/subscriptions/eventarc-us-central1-smart-dispatcher-topic-test-trigger-1zb7crbq-sub-909",
    }


@pytest.fixture
def geoevent_v1_cloud_event_payload():
    timestamp = datetime.datetime.now().strftime("%Y-%m-%dT%H:%M:%S.%fZ")
    return {
        "message": {
            "attributes": {
                "observation_type": "ge",
                "device_id": "none",
                "outbound_config_id": "38ebbae6-2535-43f9-be88-96f9daec83f3",
                "integration_id": "c25a53f6-e206-43dd-8f62-a3759565ae3d",
                "tracing_context": "{}",
            },
            "data": "eyJjYV91dWlkIjogIjE2OTM2MWQwLTYyYjgtNDExZC1hOGU2LTAxOTgyMzgwNTAxNiIsICJwYXRyb2xfcmVxdWVzdHMiOiBbXSwgIndheXBvaW50X3JlcXVlc3RzIjogW3sidHlwZSI6ICJGZWF0dXJlIiwgImdlb21ldHJ5IjogeyJjb29yZGluYXRlcyI6IFstNTEuNjg4Njc1LCAtNzIuNzA0NDY1XX0sICJwcm9wZXJ0aWVzIjogeyJkYXRlVGltZSI6ICIyMDI0LTAyLTE2VDExOjUyOjAzIiwgInNtYXJ0RGF0YVR5cGUiOiAiaW5jaWRlbnQiLCAic21hcnRGZWF0dXJlVHlwZSI6ICJ3YXlwb2ludC9uZXciLCAic21hcnRBdHRyaWJ1dGVzIjogeyJvYnNlcnZhdGlvbkdyb3VwcyI6IFt7Im9ic2VydmF0aW9ucyI6IFt7Im9ic2VydmF0aW9uVXVpZCI6ICIzYjNkYTFmMi01YTNmLTQ3Y2YtYjlkMS1jZmMxMGYzYzYxNzAiLCAiY2F0ZWdvcnkiOiAiaHVtYW5hY3Rpdml0eS5wb2FjaGluZyIsICJhdHRyaWJ1dGVzIjoge319XX1dLCAicGF0cm9sVXVpZCI6IG51bGwsICJwYXRyb2xMZWdVdWlkIjogbnVsbCwgInBhdHJvbElkIjogbnVsbCwgImluY2lkZW50SWQiOiBudWxsLCAiaW5jaWRlbnRVdWlkIjogbnVsbCwgInRlYW0iOiBudWxsLCAib2JqZWN0aXZlIjogbnVsbCwgImNvbW1lbnQiOiAiUmVwb3J0OiBQb2FjaGVycyBBY3Rpdml0eVxuSW1wb3J0ZWQ6IDIwMjQtMDItMTZUMTE6NTI6NDcuNDM2MTMxLTAzOjAwIiwgImlzQXJtZWQiOiBudWxsLCAidHJhbnNwb3J0VHlwZSI6IG51bGwsICJtYW5kYXRlIjogbnVsbCwgIm51bWJlciI6IG51bGwsICJtZW1iZXJzIjogbnVsbCwgImxlYWRlciI6IG51bGwsICJhdHRhY2htZW50cyI6IFtdfX19XSwgInRyYWNrX3BvaW50X3JlcXVlc3RzIjogW119",  # pragma: allowlist secret
            "messageId": "9155786613739819",
            "message_id": "9155786613739819",
            "publishTime": timestamp,
            "publish_time": timestamp,
        },
        "subscription": "projects/cdip-stage-78ca/subscriptions/eventarc-us-central1-smart-dispatcher-topic-test-trigger-1zb7crbq-sub-909",
    }


@pytest.fixture
def er_event_v1_cloud_event_payload():
    timestamp = datetime.datetime.now().strftime("%Y-%m-%dT%H:%M:%S.%fZ")
    return {
        "message": {
            "attributes": {
                "observation_type": "er_event",
                "device_id": "eventtype:169361d0-62b8-411d-a8e6-019823805016_humanactivity_poaching",
                "outbound_config_id": "38ebbae6-2535-43f9-be88-96f9daec83f3",
                "integration_id": "c25a53f6-e206-43dd-8f62-a3759565ae3d",
                "tracing_context": "{}",
            },
            "data": "eyJjYV91dWlkIjogIjE2OTM2MWQwLTYyYjgtNDExZC1hOGU2LTAxOTgyMzgwNTAxNiIsICJwYXRyb2xfcmVxdWVzdHMiOiBbXSwgIndheXBvaW50X3JlcXVlc3RzIjogW3sidHlwZSI6ICJGZWF0dXJlIiwgImdlb21ldHJ5IjogeyJjb29yZGluYXRlcyI6IFstNzEuMjYxOTk4LCAtNDEuMTQ1MTI3XX0sICJwcm9wZXJ0aWVzIjogeyJkYXRlVGltZSI6ICIyMDI0LTAyLTE2VDE5OjI3OjEwIiwgInNtYXJ0RGF0YVR5cGUiOiAiaW50ZWdyYXRlaW5jaWRlbnQiLCAic21hcnRGZWF0dXJlVHlwZSI6ICJ3YXlwb2ludC9uZXciLCAic21hcnRBdHRyaWJ1dGVzIjogeyJvYnNlcnZhdGlvbkdyb3VwcyI6IFt7Im9ic2VydmF0aW9ucyI6IFt7Im9ic2VydmF0aW9uVXVpZCI6ICJiZWU2NDBhMy0wNDA0LTQxZGYtYjQ3ZS1hZWE4ZGE0Zjk4NjUiLCAiY2F0ZWdvcnkiOiAiaHVtYW5hY3Rpdml0eS5wb2FjaGluZyIsICJhdHRyaWJ1dGVzIjogeyJhbmltYWxwb2FjaGVkIjogImxpdmVhbmltYWwiLCAidGFyZ2V0c3BlY2llcyI6ICJiaXJkcy5pbnRlcm1lZGlhdGVlZ3JldCIsICJhY3Rpb250YWtlbmFuaW1hbCI6ICJyZWxlYXNlZCIsICJudW1iZXJvZmFuaW1hbHBvYWNoZWQiOiAxfX1dfV0sICJwYXRyb2xVdWlkIjogbnVsbCwgInBhdHJvbExlZ1V1aWQiOiBudWxsLCAicGF0cm9sSWQiOiBudWxsLCAiaW5jaWRlbnRJZCI6ICJFUi00OTU0OCIsICJpbmNpZGVudFV1aWQiOiAiYmVlNjQwYTMtMDQwNC00MWRmLWI0N2UtYWVhOGRhNGY5ODY1IiwgInRlYW0iOiBudWxsLCAib2JqZWN0aXZlIjogbnVsbCwgImNvbW1lbnQiOiAiUmVwb3J0OiBodW1hbmFjdGl2aXR5X3BvYWNoaW5nXG5JbXBvcnRlZDogMjAyNC0wMi0xNlQxOToyODo1MS4xMTg2MTAtMDM6MDAiLCAiaXNBcm1lZCI6IG51bGwsICJ0cmFuc3BvcnRUeXBlIjogbnVsbCwgIm1hbmRhdGUiOiBudWxsLCAibnVtYmVyIjogbnVsbCwgIm1lbWJlcnMiOiBudWxsLCAibGVhZGVyIjogbnVsbCwgImF0dGFjaG1lbnRzIjogW119fX1dLCAidHJhY2tfcG9pbnRfcmVxdWVzdHMiOiBbXX0=",  # pragma: allowlist secret
            "messageId": "9155786613739819",
            "message_id": "9155786613739819",
            "publishTime": timestamp,
            "publish_time": timestamp,
        },
        "subscription": "projects/cdip-stage-78ca/subscriptions/eventarc-us-central1-smart-dispatcher-topic-test-trigger-1zb7crbq-sub-909",
    }


@pytest.fixture
def er_event_v1_with_attachment_cloud_event_payload():
    timestamp = datetime.datetime.now().strftime("%Y-%m-%dT%H:%M:%S.%fZ")
    return {
        "message": {
            "attributes": {
                "observation_type": "er_event",
                "device_id": "eventtype:169361d0-62b8-411d-a8e6-019823805016_animals",
                "outbound_config_id": "38ebbae6-2535-43f9-be88-96f9daec83f3",
                "integration_id": "c25a53f6-e206-43dd-8f62-a3759565ae3d",
                "tracing_context": "{}",
            },
            "data": "eyJjYV91dWlkIjogIjE2OTM2MWQwLTYyYjgtNDExZC1hOGU2LTAxOTgyMzgwNTAxNiIsICJwYXRyb2xfcmVxdWVzdHMiOiBbXSwgIndheXBvaW50X3JlcXVlc3RzIjogW3sidHlwZSI6ICJGZWF0dXJlIiwgImdlb21ldHJ5IjogeyJjb29yZGluYXRlcyI6IFstNzEuMjYyMDQ1LCAtNDEuMTQ1MTI4XX0sICJwcm9wZXJ0aWVzIjogeyJkYXRlVGltZSI6ICIyMDI0LTAyLTE5VDA5OjQxOjAzIiwgInNtYXJ0RGF0YVR5cGUiOiAiaW50ZWdyYXRlaW5jaWRlbnQiLCAic21hcnRGZWF0dXJlVHlwZSI6ICJ3YXlwb2ludC9uZXciLCAic21hcnRBdHRyaWJ1dGVzIjogeyJvYnNlcnZhdGlvbkdyb3VwcyI6IFt7Im9ic2VydmF0aW9ucyI6IFt7Im9ic2VydmF0aW9uVXVpZCI6ICIxZDFiNTU3Yi03MWQ1LTQ0YmMtYTczZC0yNTEzZjQwMmFlZWMiLCAiY2F0ZWdvcnkiOiAiYW5pbWFscyIsICJhdHRyaWJ1dGVzIjogeyJ0YXJnZXRzcGVjaWVzIjogImJpcmRzLnllbGxvd2JpdHRlcm4iLCAibnVtYmVyb2ZhbmltYWwiOiAxLCAiYWdlb2ZzaWduYW5pbWFsIjogInJlY2VudCIsICJ3aWxkbGlmZW9ic2VydmF0aW9udHlwZSI6ICJpbmRpcmVjdG9ic2VydmF0aW9uLmZvb3RwcmludCJ9fV19XSwgInBhdHJvbFV1aWQiOiBudWxsLCAicGF0cm9sTGVnVXVpZCI6IG51bGwsICJwYXRyb2xJZCI6IG51bGwsICJpbmNpZGVudElkIjogIkVSLTQ5NTUwIiwgImluY2lkZW50VXVpZCI6ICIxZDFiNTU3Yi03MWQ1LTQ0YmMtYTczZC0yNTEzZjQwMmFlZWMiLCAidGVhbSI6IG51bGwsICJvYmplY3RpdmUiOiBudWxsLCAiY29tbWVudCI6ICJSZXBvcnQ6IGFuaW1hbHNcbkltcG9ydGVkOiAyMDI0LTAyLTE5VDA5OjQyOjE0LjU2OTE1OC0wMzowMCIsICJpc0FybWVkIjogbnVsbCwgInRyYW5zcG9ydFR5cGUiOiBudWxsLCAibWFuZGF0ZSI6IG51bGwsICJudW1iZXIiOiBudWxsLCAibWVtYmVycyI6IG51bGwsICJsZWFkZXIiOiBudWxsLCAiYXR0YWNobWVudHMiOiBbeyJmaWxlbmFtZSI6ICIyMDI0LTAyLTE5XzA5LTQwLTQzX3dpbGRsaWZlLmpwZyIsICJkYXRhIjogImd1bmRpOnN0b3JhZ2U6NDZkMjIyZjUtMDFjZi00YjRjLThiZTEtNjUxNjA0NTQ4NzBhLmpwZyIsICJzaWduYXR1cmVUeXBlIjogbnVsbH1dfX19XSwgInRyYWNrX3BvaW50X3JlcXVlc3RzIjogW119",  # pragma: allowlist secret
            "messageId": "9155786613739819",
            "message_id": "9155786613739819",
            "publishTime": timestamp,
            "publish_time": timestamp,
        },
        "subscription": "projects/cdip-stage-78ca/subscriptions/eventarc-us-central1-smart-dispatcher-topic-test-trigger-1zb7crbq-sub-909",
    }


@pytest.fixture
def attachment_file_blob(mocker):
    return b'\xff\xd8\xff\xe0\x00\x10JFIF\x00\x01\x01\x00\x00\x01\x00\x01\x00\x00\xff\xdb\x00\x84\x00\n\x07\x08\x15\x15\x14\x18\x15\x15\x15\x19\x19\x18\x1a\x1a!\x1b\x1b\x1b\x1b\x1b\x1d\x1c\x1a\x1d\x1b\x1d\x1f\x1b\x1b\x1a\x1d\x1b\x1a\x1d!-$!\x1f*\x1f\x1a\x1a%7&*.1444\x1b$:?:3>-341\x01\x0b\x0b\x0b\x10\x0f\x10\x1f\x12\x12\x1f3*$*53<<3333335333333333333333333333333333333333333333\xff\xc0\x00\x11\x08\x00\xb7\x01\x13\x03\x01"\x00\x02\x11\x01\x03\x11\x01\xff\xc4\x00\x1b\x00\x00\x02\x03\x01\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04\x05\x00\x02\x03\x06\x01\x07\xff\xc4\x00<\x10\x00\x01\x02\x04\x03\x06\x04\x05\x02\x06\x02\x02\x03\x01\x00\x00\x01\x02\x11\x00\x03!1\x04\x12A\x05"Qaq\x81\x132\x91\xa1B\xb1\xc1\xd1\xf0\x14\xe1\x06#Rb\x82\xf1r\xa2\x92\xc2\x15C\xb2\x07\xff\xc4\x00\x19\x01\x00\x03\x01\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x02\x03\x00\x04\x05\xff\xc4\x00$\x11\x00\x02\x02\x02\x03\x00\x03\x00\x03\x01\x01\x00\x00\x00\x00\x00\x00\x01\x02\x11!1\x03\x12A"Qa\x132\x81q\x04\xff\xda\x00\x0c\x03\x01\x00\x02\x11\x03\x11\x00?\x00\xdds\x0b\xd0U\xbd\xa0o\xd3,\xd6\x1d&K\\F$\xb5#\xcaR\x19\xa1.%*\x10\xc3eK\xdd*\xd6&=\x02\x91\xee\x1ahN\xeb^\x0c\x9d\xac\x05,\x9a\xcd\xc4\xd5\x86\xb0\x12\xf1D\x185r\xd2\xa3\x00\xcc\xc0\x9c\xdb\xb5\x89R\x08jgf\x96N\xb0\x97\x14\xb2\xa55\xa1\xe4\x9c\x01K<i\xff\x00\xc6\x8f6\xb0a5\x135g=\x88\x19\x11\x02\xeca\x9eetx\xe81;4\xa9%\xc4+\xd9\xf82\x16\x07\x13\x16SN,J\xc8n#\x10\xa7m\x05\xa3\xc9x\x82Hxk\x8c\xd9\xac\x91\x03\x0c\x00g\x89\\h9\xb0\x9c2\xd8\x861\xa2\xc6e\x18\x0b\t$\x95\x06\x82\xa7\x86P\x898\xe4k=\xf0\x081y\xb8}LR~b\xc4XDN+B S\xbb\r\x81c&\x94\x98#\x0c\xbc\xc9\x8b\xaaXYf\x8bK\xc3e$C\xe2\x80a9\x0cc\xc2\t\x10rP\x0e\x8ec\t\x92\xd4\x951\x14\x82\x99\xa8\x9b9C3\x18)s\x00%\xa0\x15(\x82J`4MXQ\xcdBm\n\xd3l:\x1d*c\x88\xa4\xd5\xa5\x83\x90\xe6\x04J\x9a\xf1\xba7\xb4nq\xa8\x01(\x9b\xba\x05]\x85\xc3qK\xfb\x18\xf2n\x1bw4Vt\xed\xc4\x9dF\xebpj\xfc\xd4} \x11\xb4X\xb1\x8dW\xa0\xc9\x9b\x04\x02\xdc\xa3i\xc1-h\xb9J|<\xc0u\xf4\x109\xc5\x86\xcaD\x1c\x9bE\xd6\x8c\xc0\x03\xa4f\x99C3G\xbe0\n\x03\x8c\\\xa4\xe6\xe9\x06\xda\x00\x1c\xf4\x14\xb8\x02(\x84n\x12o\x0c&\xaf\x95\xe0LBl \xa6\x06\x80\x90\x15A\x05\xcbZ\x93\x14\x12T\xef\xa4{\x99J\x06\x90\xcf \x08T\xe1\xc6$\x0f\xfauD\x81a\xa2\xbbcj\td\x15n\x82@\x04\x90B\xbb\x07n\x0fw1\xa6\x06h\x98\x8c\xc6\xe6\xa3\xa1\xa8\x1e\x8d\n\xb6\xae\x00\xaebAFt\xf1U@e\'.\xf6\x84\xef\x1e\xc2\xb0v\xcf`\x1a\xdb\xca\xa7\xf9\x1av\x86qJ*\x82\xb2k9N\xf4\x81fJ!\x88\xd6\x08\x9c\xbc\xa4G\xb8\xd9\xc3.W \x90\xd4\xbb\x1e\x10?\x11\x8bH\x96\xc8\xccL\x15\x84K\x97\x10\xbf\x0b0\t +1 \x07\'Z97\xe5\xac\x1d\x80\x9e\x19\xc0-\xc0\xd0\x86\xa1\x84\x920~g\x16\xacj\x83\x95.\xaaF(\xc4\x07\x10\x16\xd6\xc5\x05\xa4\xa4=\x01/\xa3\x80i\xed\xef\x08\x90\xe1\x85`\xcbQq\x98$\xb753\x12\xde\xa1\xa3\x9d\xfe\x1e3\t\xcd<\x00\xac\xce\x00`X\xbd\x18R\xcd\x04\xc8&\\\xb4\xa4\xa8\x96\x04\x92tO1\xd5A\xdb\x94\t,\xa8MH}I#\x90\x04|\xda*\x96\x1aB\x1dd\xe6Q\xe5\x00\xcdH\x05\xb4\x82\x134R\x90\xbf\x17\x8a\xde \nDb3AR\xd0\x12\x0b\x08\x1f!*\x8ba\xe6\x92+\x17HcH:\x14\xdeF\x1c\x80sF\x7f\xa7m)\x12v-\xe9\xa8\x8dL\xf7Kk\x01\xb6="\xb2\xe4=\xa9\x1e\x89E\xef\x14N#H\xda\xb7\x81`\xa2\xd2Q^qM\xa3!J9\x9e\xd1S2\x08\xf1\x1d-\x196\x10l6\x13*\\\xd4\xc4\xc4\xc9IHqX!\n\xa8\x0fH\x17\x1e\xb2\x97f>\xbfH\xd6\xdb3\x01\x9a\x18\x90\x18\xb6\x80\xd7\xf6\xf4\x82\xb0\x93h\xd9K\xf3\xfb\x88\xc4\x99\x84%M[\x10-Vv$\xd0v\x830\xc5#\xcc\x92\x0fo\xc3\xd0<>\xc5\xac\x99\xccPR\x0b\x0b\x80\xb0\x1a\xae\x01pxn\x92{BA,\xa9V\x87*\x9b\x91\xcd\xeaHg\xa0/\x99\xfa\x87~\xb1\x8a\x15\x98\x82\x12G#v\xd2\x1e84\xb2k!\xc4\xb0\x98\x1f\x15).\xfa5a\x81l\x8e\x93]A\xbd/\x0b&\x85\x11Z\x1a\x80u\x0f\xc2\x04v\x06\x0e\'\x00\x12\xa4\xb3\x90H\xa8,h\xc0\xd6\xeeE9\xc1\xeb\x9c\xe4(\x17xM\xb3\xa5\x838\xcb!\x8aB\x94\x90\xe2\xc5@\x02\xe3\x95[\x9c:F\x1b"\x03\xd0%\xeb]\t\xe4\xe6\x1ai $\xcc1\x0b\'\xfd\x1fn66\x8c\xca\xd8\xef\x8fO\x97\xe7xe/\x0c\x95\x9c\xe4>P@br\xd4\xb9$;\x12\x18W\xed\n\xb1!Af\x91\xa3O\x06x6\xfd@f\xfch?\x0c\xa0e\xab\x8d\xc4+\x9a\x92\xa2\x82\xd7G\xb8*\x1f = \x99\x8aVQ\x94Z\x0c\xa3L\xc8\xcb\xf5Q"\xb9\t\x89\x1b\x06\xc9\x8a\xf1\xa1\x85CF2\'\x80\x82\xa7\xf8\x8f\xcc\x98\xe5\xb18\xa2Hj4o\x83R\x96\xc9\x174\xfb\xc5\x7f\x8e\x90\x13\x08\xc4\xedg&\xf7\x7f\xf5\x1a#\x14fo\x0b\xb3@\xab\xc2\xa5*cuW\xe4\xe6\x18adU j\xa7\xec+\xf6\x82\xd2\xa3z<\xc3\xc9\xcb\x91\xed~\x947\x8c\xbc|\xaa\xf3u\x1c\xc7\xe1\x8b\xe2\xa6\x80+\xf0\x86\xebBi\xd8\x18NPT\\\x1a\x15z\x165\xf9\x88\x8a\x85\xa1\xecc\x89\xdaa$\x01cG\xe7\xa4\x0f\x8bX\xf0\xca\x96X\\\x17fP\x14s\xc0\xfe\xda\xc2\xf5\xe0VT\xe4\x128r\x831\x05\x19\x15&hQ\tI&\x9e`*\xf6\xe0\x14+\xac2\x8aU@\xb0\x8d\x9f\xb5\x04\xc5\x12\x90\x9a\xa5!N\\3:\x80\xb3\xa8\xbaG\xf8\xc50\x13sNW\x04\xb2\x1c\xd6\xc4\x93\xd4\x91\x96\xbc\xa05\xc9\x12\xd0\x00\x1b\xc5,@\xfe\xa5+1r=\x87\x03\xac\x13\xb2\xceCJ\x9f\x99\xd4\xfa\xbcf\x95:1\xd1\xce\xc4\x06\x80Vu\x8dQ,\xabN\xb1\xec\xc4\x00\x96\xe1\x10I]\x05\xd8N\x16S\xa4\xf4\x80\xa5\xcfe\x10\xee\xd0V\tg)\x0f\x19N\xc26\xf3^7\xb95^\x81\xa6M\xab\x80\xf1b\xb2\xeeN_\x97\xacY8\xa9`e-K\xbf\xef\x16\x9d\x8b\x95\x94\xa5A\x81\xe7\xf2:A\x7f\xf0\xb48\xdf\xa6\xb2\x90\xe4\xb1\xafW\x1e\xbfH/\x0c\x1c\x14\x1a\x18\xe70\xd8\xb3-{\xb3\x02\xd2\xf4\xd1C\x91\x16\'\x81\xd4i\x1d\x0e\x13h\xa5e\x88f-\x10\xe5\xe5P\xf0\xe8\x8f\ne\x94\x82=>\xff\x00h\xc8\xe2\x0ed\x88&D\xe4\xa9fZ\xcb=\x02\xbd\xc4\x0f3\nB\xdb\x847\x1c\xd4\x95\x9c\xfc\xbcN,)L\xce\xf5\x8c\xd0\xecM\x1c\xfa\x8evh\x19\xcb\xb6\x90Bf\x05-\xac\x1a\xf0\xd4J\xcc?V\x02\xebA\x19\xedE\xab)\xca\xb0\x92Hb\x03\xb0\xb775\xb5:\x88(a\x10\xa2\xe7Cx\x17\x1f,\xa5MV:\xc1\x8dY\x9e\x81\xe4\xcc9A\x19\xa8\x00g<\xdc\xd8\x06\xd2\xc2\x9dbJYJ\x06\xf8r\x9d\x01\xa1,\xd5\xe0+\xa5\xfa\x96\xcf\x0b\x83\x98\x95-^!(4J\x1a\xd6\xec\xf7\x1d\x1a\x0e\xc3a\xc1Hr\x1cP\xa7^\x91LX\x12\xb2\xbb=\x04 \xd7y\xcen\xa1\xf4\xb8\xa3EL\xc2]\xc5G\xa4m)*I[\x00\x13B\x0b\x9c\xe5\xe8s\x06\xab\x00\x90\xef\xc1\xe3q,e\xe6 <34&\x181.h\x98\x90\x92JHQ \x02I\xbd\x054\x1e\x91t\xa8\xac)*\xa8\xcc\xa6<\x05\x83h\xf7\x03\xd6\x19,$\x8e\x82)\x85\xc32*\x9c\xacM\r\xdd\xef\xde\x0fkVn\xa6x\x19\xbe\x12<6\xb8\x0ey\xd8\xf6\x0f\x1b\xac\x07v\xacy\x90\xb8TEK\xab\x83K\x91\xf6\xfbF\xd9\x92\x04\xc4L\n(`\x02\x83\x9fJ\x7f\xed\x17\x90(\xe4\xd4\xc4\xc3\xa1"b\xc9S\xe6!\x86\x8c\x00ow=\xe3D\xa99\x88\x03X/\xe8\x00\x93\rMbASp\xc9s\x125\x9a\x8f\x9a\x95$\x96\xaf\xa8\x7fX#\x0c\x0b\x86?\xbf\x0fs\x01\xa8\x01X/\x02\x1c\x13x\xecyB\x07\xe2\xe6\x00\x02\x89\xa8\x07\xfdF8\x1d\xa6\x04\xc1[B\xdct\xc2A\xe5\x0b\xa5Lc\x01B\xd6Lw\x1bVz\xa6 \x94\xd4\x12\x07\xa7.\xa6/\x80^U\x80t\x1djA\x0e5\xff\x00p\x87\x0f\xb4\xd9\x0c\xe2\xe0\xfb\xbc\x13\x82\xdaIw\'x\x97\x7f\x97a\xc2\x11\xc3\x14k:\xb41 \x10\xc9\xbdnoF\xe1\x03c\xe6\x85\xccC\x1a\'yg\xfbI\x0c?\xf2HW\xf8\x1e0\x12\xf6\xc2K\x1b\x90\r\x05\x7f\x073\x01\xf8\x84\x82V\x0e\xf7\x99<y\x16\xd0Y\xb5j\xea"Q\x87\xacn\xc18\x95\xe6QPl\xae\xc9\xe6@b\xaf\x98\x1dLm\x80FR\xf0\x1e\x19\xd53\x82D2\xc4a\xd4\x92\r\xdc\xd2\x19\xe3\x06\xb1\xbc\x99\xb9PH\x15h\x1eL\xc2\xb2\x0b\x16\x8ba\x92FZP\xde\x1a\xe1\xd2\xc9t\x80\x005\x8ey`d\x07"R\xaal\x04\x0b\xb4\xb1\xa6\xee\xc3\x86\x9d\xf8E\xb6\x86\xd1\xcc\n\x11\xad\xc8mz\xd29\xbd\xad\x8a(M\x14\x90tu9\xf6h1\x8f\xd9hC\xd0-\xa5\xb7\xa6&\x8e[\x88\xfa\x10)\xe8`l<\xd5\xceb&P\x9f*\x94\xe6\xdcXR\x03\x93\xb5T\xec\xa5\x8e,\xaa\x83\xeb\x06\x7f.`\xce\x90\x84\x10*\xaa7w4\x1dK\xc5%\x85\xa2\xd1V7V1(\x19\x00\x01l,AJ\x85\x18\x828\x1f\x9c\x1f\x82\xcd\x98\xa9F\xac\x0b\x08\xe2\x7fP\x99k\nT\xc2r\x9a%\tv\xe4TH\x03\xa3\x18k\x87\xdb\xc1H)\tVg,\xa0\x0e`\xf5\xa8\x17\x1dc\x97\x9b\xff\x00<\x9cq\x92\xf0\xe4\x8d\xe4\xfa.\xca\x98\x85\x90\x85\\[\x8b\xff\x00\xb8jpJ\x0e3\x85pp\xca\xd5\xc1\xe3\x1f=\xd88\xd5\xcb\x98\x930\x83\x98\xe5w\x14\x00=y\xd4\x08\xec\x0e=\xeaU[\xdf\xef\xf9H\xe7\xe2\xb8|^\x7fM\xc9\x1e\xc1\x13\xb0\xe4\n\x83\xadZ\x9d\x8c\x04e\xb0x\x15\x7f\xc4\xc8\x13\x93$+x\x96\xcaH\x1b\xc7K\xb9\x7fk\xc6\xcbT\xc2\x19Cx\x1a\x808|\xcfH\xe8NKj\x8eI\xf1z\x8b\x99\xd9C\x18\x1bhm \x00HbI\x85\xf8\xccu\x084n7\x85\x13\n\x9c\x12oPb\xd1\xe3\xb7\x93\x9eR\xad\x1dn\x0b\x12\x92\x9bW\xeb\xa5\xe0Y\xcb\x15\xe0\r]\xf5\xad9\x82\xfe\x8d\x19\xe0\x14\x15%G\xe2\x16\xe7\x18\xaaZ\xdby\x80&\xe4\xd4\x1eO\xdf\xd6\n\x8f\x86\xb0\xe1=@\x05\x06}\x1cn\x97\xd0\x8eu\x04\x88"|\xe0\x08!\xca\x15n=\x0f1\xf6:\xc0\xd2S\xfc\xa0\nE\x084\xa0\xf8\x89\xfaz\xc6S1,R\x86d\x96\xea\x00\xab\x8eb\xbd\x9f\x801\x92\xbc\x1b\xc1\x8a\xa6\xa4\xe5,\xdf\x96\x8dg\xcc\xcc\x97\x06\xd0\xbd+$\x9bn\xb3\x7fp,B\x87#~\x91tb\x00a\xab\x9e\x8c`8\xbb\xd1\xbb\x19\xa2ar\xe6\xd1\xa2&\x86<G\xe7\xd2):X\n,A\x81\x82\x81%\xd4H\'O2t"\xd6.+\xfe\xe1\x94E\xb0\xc2Q\x931\x00eY\x04\xf2g\x05\xba\x85B\xe5\xe3\xc4\xba\xb3\x96p\x03:\xad\xf2&\xd0\\\xe9j2\xd49\xa4\x95\x155\x01)$\xde\xf9\x83\xf7\x85+ \xbaH\xdeQ\xb1\xb0a\x98\xa9\xb4`_\xd3\x8c:I\xe4\xcd\x84\xab\x171D\x94\xcap\xe48P\xb8,}\xc1\x8f!\x9c\x99YR\x12\x9c\xa0\x00\xc1\xc9\x89\x02\xff\x00\x03H\xf9N!jkC]\x98@@r\xc4\xd8~\xd1q!+\x00\x01Vs\x07\xe1\xb6~D\xa4e\xa1\xde~]c\xaeRTM!n7\njY\x87;\xc25\xb5\xa3\xad\xc6\xa1\xd0\xae\x007(\xe3V\x85\x19\x8c!c\x90\xb3y(0\xc3\x0f\x85z\x9b~i\x14\x122\xa6\xba~} \xdd\x9c\xb0I{\x80i\xda\x19\x8bC\xcd\x8b\xb3\x0e`\xe0\x0f\xed#\xe7\xc4\xc7A\xb4vr\x11/8g~\x10\xbff\xacgI*\xf3\x02\xcf\xd37\xcd\xa3-\xb3\xb4k\x95\xea\xf6\xb6\x96h\xe5\x97g"\xaa\xa8\xae\x01\x92\xbe5\xaf\xaf\xed\x0f\x04\xbc\xf9l\x19\xdfJ\\\x0f\x7fhG\xb2\x12\t\xde \x93[\xda\xcd\xdfXu\x8c\x9c\x84\xa9\x01\xa8\xe2\xaen\xd9@nn{\x88\x9c\xed\xbaFT\x82\xb3\x86aa\xdc\xc0\xf3\xb1\x0bJ.\xcfq\x14\x9a\x02\x01\xde\xbdH\xb3W\x89\xd0\xd7\xd2\x17b\'\xa1\xb7\x89\xe9S\xf4\xfa\xc4\xea\x8b\xf1EI\xdb\x04\xc6O*\x07)\xa7\x10\xcf\xeba\xe9\x1c\xb6?\x18\xa0\xa69\xf2\xf2Ps\xd6\x8f\r\xb1sK\xb0\x0e?\xe3X]\x8b\xc4\xa5\xb2\x81\xd7\x99\xd09\xd3\xa7\xed\x16\x89f!8\x84\xadA\xd2RG\x971py\x1bF\xbf\xac}\xd0\xfc2\xd7\x97:\x0e\x90J\xe5\xa8\x83\xe5j\xe6\xa8\xa7U_\xb4\r*Pp_\xce[\xb5\x1f\xf3\x94_\xe2\xc9\xe5\x19\xaf\x10S@\x12\xe4\x92\x97\x15/\xde\xac\xd1\xe6\x0fj\xcc\x0b;\xa330\xa3\x109\x0b\x13\x16\x9b#{\xe4zX\xfc\xe0\x9c>\xccQ9\x80r\xdd={\xc37\x05\x1c\xa0|\x9b\xc3\x1d\x7f\x0f\xcb\x02Z\xe7-\x19\xf4JR\xa2\nN\xaaV\x82\xa7W\x8e\xb7\x01\x88\x13$+@\xd5\'\x8d9Y\xe1O\xf0\xc6\x05\xd0\xa4+\x9aI\xd1Ik\x1fx\xdeR\xd2\x8f\x12B~\x04\xbaA5\xa2\x80\xfa\x88\xe0\x97\xcagJ\xc4ro\xb2\xcc\xa5\xeeL\x94\x83\x94\x9f2E\xc8\x00\xdd\xcekV\x90\xd1\n\\\xa5\x19\x92\xd5\x99\t5\x97}\xd0\x00\xdd7\xa0\x14\x07\x9da4\xe5\x89\x92\xc1J\xd2\x14\xc1\x9d\xcb\x07\xe2:Z\xf4\x80\xd5\xb5&J\x0cN\xe94k\xf5#\xa4R\x94\xb0OGI\xb4\x04\xb9\xcaK\xa5\xb3\x0f:X\x93\xc1\xc7\xc4=\xf9\xc2\xbcF\xc7\x98\x84\x82\xad\xf46\xea\x92X(\xd4\xb7\xf6\xabV>\xf0*\xa7\x15\xa72IB\xb2\x9c\xa4\xa4)\x8b\x069C\x92\x1c\x8fC\xc6=\xd9\x1bOhL\xf10\xf8\x90\x12\x82\x12R@\xb9\xcc\xe1I/P@\xfar\x86\xe3\x8b^\xe8\x972\x8d]d?\x04\xb2\xa0\xc0\x94\xa4$\x9c\x8d\xce\x80\x93W\x01\'\xd6/\x89YR\xcaI 1\xbf(\xbaRM^\x80\xb1\xa3Q6=Ha\xeb\x18\xcc\x96\x9a\x94\x8d\xd07j\xfe\xa65\xad\x9c\xed\x0c\xf0\xacP\x1e\xdfRo\xec\xde\x91\xe6&Rrf\xbd\x0fK\x83Ox]\x85\x99\x9d%%$\x05\xb0\x15\xf2\xb7\xc5\xf7\xb5\xbd\rL\xe2rK!\xca\xdd*P\xf8T\x053\x0b\xb9\x04\xd3\x91\x8aF9\x0e\xd6\x01\x00,\x84\x13E\x13\x90\xbb1\xbeW\xfe\x92}\t}L\\\xa8\x82\x01z\x1fN \xc6\x92\x03\x95fK\xe8\x84\x81`\xf4\x03\x9d\t\xf51\xba\x95_\x11I%Hb\xa0.\xa1\xa2\xba\x8a\x03\xc6\x87\x8c\tg\x00Q,p\xa2a\x05\xb7K\x03\xc4\xf2a\x03\xe3\xb6~Z$$\x02\x18\x81b3\xcb\xa55g\x83\xb1\x18\xe5\x14\x94\xcb\x96\x10\x19\xc5*\xf5\x8e~v(\xab)+*Vb\x90\xfc\x92\xe5\xb9\x02 Ad\xce\x87\xe9C\xa1u\t\xdd`\xc5\xcd\x06b;\x14\xa6\xa69\xfd\x9b\x87\xc8\x95\xccMJ\x8b \x9b\x84%\xf2\x9ey\x8b\x1a\xe8\x04hg\xa8\xe4@\nM\tX:\xa0\xb0UF\xaaK$\x02\xc7] ,d\xd2\x95\x04\xa8\x0c\xa9\x1f,\xdeVv\x16\xe1\x0e\xa3\xe0\x1b\xc1\xa6c\xa9 \xea\x06X\x90$\xd5\xb9,\xb2\xda_\xed\x1eE:\xb2b\xfd\x82\x85\x14\x93\xc7\xf1\xa1\xb6+\x14\x04\xb4\xa4\x96\x0c\xdcH\x1a\xb7\xb4(\xd98\xcc\xa1\x93M\x0f~\xff\x00H\x98\xc5f! \xb8&\xf0\x1a\xc9K&\'\x12<5\'5^\x97\xfc\xaf\xd2\x10\xc8I**\xd2\x0f\xc5\xa4\xe5\xcb\xef\xa4k\xb1\x90\x8af\x0eA\xf5\xef\x0f\xfdS\x15\xbb\t\xc0\x10\xb0\xea\xd3\x95;\xf1\xfd\xa2\xdf\xa5\xca^\xf4\xb8\xbdyF\xd8\x89y\tf\xb0?"\xdc\xc3?\xa4\x15\xb2\xcf\x8a\xb4\xcb\t7erH\xa9/\xa5\xfe\x9a\xc2\'j\xcc\xb3\x83\xc9\xb8\xd3)!"\xe2\xa5&\xa0\x8b\x06:\x17\x16\x85y\xf3-\x0e\xf5\x0e\\\x16\xa6\xae\xf56\xf7\x8e\xa7\x1f6\\\x83\xba\x01Y\xba\x8d\xcfN\x03\x90\x836t\xe11;\xc0)-e\x0fXO\xe4\xa5tZ<V\xea\xcc69\t\t\x04\x03\x98\xd1$\xb1,\xceS\xd9\xe9\xc0r\xad6\x84\xdc\xc9&^rB\x8dEj+n\xbfX\x92\xf1\x12\xfcE\x0c\xa1\xe5\xa7t\xf0J\x8b\x16\xee\xa6~\x06\x1e\xe1g&\xc0Ptg\xe7\xce\x17\x1f\xd8+\x85\xe9\xb1d\xe5\xa8\x80\xe9S\x10\x15\x9b*\x85hZ\xb5g%\x87\xca\x14c\x16]\xdb\xbf\x08\xeb\xb1\x93\x93\x91U\x8eNy\x0cTAW\x04\xd5\xbb\xc4Z\xc9\xd1\x08\xf5@\xf8ex\xae\t*#\x8d\x9b\x88C\xfb\xb4\x03\x8b\xd9\t\xa9\xcc\x1f\x95\xdf\x80\xa3AXL2\xd4\xa03eB\xaa\xb0\x92\x03\x91\xa1:&\x8f\xde\x0e\x9d\xb1\xd2\xd9\x82\x8a\x9e\xc9\xadx07\x1c\xcc$\xa5\xd6[)\x1ah\xe3gIZ~\x14\xb0qrC\xf6aJ\xc4L\x94\x80\x14\t\xcc\xd4v\x06\xbcF\x81\xb8\xc3\\B\x14fe\xf0\xc1\x02\xf9\x95\xba\x91\xd0S\xd2\x15M\xc3)S\n\x94\x00\x00\xe8\x0b7\x0f\x90\x8b\xc6_\xe0\x92FA\x19\x88\x01\x81\x0fO\xcfX\xeap\xf9D\xa0\xda\x81\xde\x84}=\xe3\x97\xf1\x12\x92\x14,\xe4|\xd2Ok\xc3\xbc2\xd9\tO\x02\xdf\xf6\xa7\xb1\x83<\xa4,0\xd8\xefc\xa0\xa15S\x0c\xe4$\xf3f\xef\xc6\x02\xdb\x00\x0cS\x15\x01\x9d\x00\x13\xf4#\x98\x1e\xc27\x93/:s\n\x04-f\xfa\xd9\xfd\xbdcM\xa9\x81J\x92&\xb1+f\xa5\x87\xda\x95\x1d\xa2:\x96J=\n\xe5/0\x04~\r)\x1e\xa3\n\xb0L\xc5\xa9\xd2\xee\x1d\xabzoP\xfaR<\xc1\x93\xe24\xbd\xe2\xa0\xe0j\xf7\xd7^\xb1\xce\xcfV)s\nI^|\xcd\x94\x80\x00\xe8\rF\xbd\xebW\x8bC\x8d7\xb5\xfe\x92sih\xfa\x0e\x03h\xa1TI!\xa8HQ\x01\xc5\xd8%\t\x16~:k\x07mLJT\x89e\x01\xb2$\xb9)\xcaMY\xd9\xa9`{\x88\xc3\xf83\xf8e)R\x17:aZ\xee\xc6\x89M\x89\xa7.p\xc7i\xa9\x06b\xd2\x94:B\x94\xae.\t`\xdc+\xf2\x83\xd5E\x12\xe4\x97l\x0b\xa5\xceZ\x92X\xe6 %\xe8\xc6\x86\x8e\xd4sS\x1a\xa0\x00\xe1,\x96\xa6[\x86M>\xd1\x8c\x85)\n!#(Xp\xf7d\xd0?\x03Zw\x88\t*\xc9V5v\xa3\xdd\x9f\x8dO\xa0\x894"\xc8n\x1a[\x82\x14JA\x15!\x8b\x13\xa1\x0fX\x98\x892\xd2\x84)E\x88]\x17]\x06\xa7\xa1"\xecNW\x88\xb5\x86\xf0\xe5\x97\x00\xef\x1b\xe8\xcd\x9b\xad\xcdb\xb8\xb5\x04\xca\t%\xd4\x1ce\xd2\xa0\x12\x06\xba\xfb>\x90\xf1\xc3\xb4\x1a\xc0\xd7\x18\xa0\x9a$\xb1\xcdB)v\xb7\x1a@\x94\x01%\xc8 \x92\xe7\xdc\xb3T3\x86\xe0Lc"b\x93//\x99I\x04\x82[\x86\xe3\xb0\xbb%\xbbs\x80\xf6\x86)\x96\x08\x04\xe5HP\xe0s\x02Y\x9a\xcdN\xf1\x9a\xa9\x1aMP^.xJ\x932\xb6=\xb2\xe8i\xa3\xd3\x91\x07X\xe7\'\xa5$\x8b\xbaV]\x8d[^\x17\xca!\xc2\x14\xa5!)VQ\x9c8%\xf7Udf\xe0\x1d\xd2\xe7\x93\xda\x13m\x19G\xc4BX9\xaa\x9e\xac\xb4\x82P\x9d\t6\xff\x00\xc4\xc5 \x92bH\'\x00\x9c\xc9%tR\x8b\xaa\xc7(\x1eP\x1a\xec\x1css\xc6\x00\xda\xcb\xcb1\x00\xb2\x14\xdb\xce]\x8ePC\xe9z;\\A8Y\xbeB\xa7\x01\xea\x01fj\xb5H\xa3\x03C\xc7\x8b@\xdf\xc4\x18\\\xca\t\x071\t\xa1\xa6\xf1s\xc3\x93\x1f\xf2\x17\x87K\xe5l[\xc0\xa1\xdd\xcb\x8b\x9b\xb3\xd0\xb5i\x1eAxTKJ\x12\x1dE\x85\xf8\xfa\xa6$S\xb7\xe0\x94s\xc8\xc4\x94\x9ak\x1bH\xc4\x9c\xc0\xf0\x8c0\xd8r\xad\x0bt\x83\xce\x19\xab\xdb\x97(\xcd\xa6\x12\x98\x99\xee\x9e\xef\x14\xc0L/G\xed\x7f\xde.\xa0\x0cz\xa9\x15k\x12\x1c@\t\xba\xf1\xa5\xd9AA\xa8\xc0\xb3\xd4\xf2\xb5\xa1\xde\xca\x9cP\x82\xb4\xddz\x9d\x05\x80\x84?\xa7Y \x13^\xaf\x0c\x0e$\xcbKrh\x9c\xf5Hh:vo\x8e\xc5\xe7X\x06\xa6:<\x0c\xc0\x10\x94\xf1\x00\x8fx\xe0\xfcbV\x15\xc2\x18\x9d\xac\xa6@{\x1az\xbcFQ\x92_\x85\xa1\xca\x93\x00\x91\xb4\xc9\xc4\xcc\x06\xc74\xb3\xff\x00\x92~\xa9\x8e\xa3\x0f\x8a 8/\xe9H\xe46\x8e\x1c%jRO\x99Y\xc7U\x00~o\x1d\x06\x04<\xa4\xb9\xd0\x1fQ\xd2+6\x92TR7y\x19\xce\xc5\x12\x86\'O\xc6\x85\xf8Y\xe9 \xbb\xb0\xab_\x8d\xccy1\xf2\xfe\x18\x1eP\tJ\xb9\xd4\xfb\xb7\xd7\xd6 \xda\xd1\xa5:7\x91\x88\xa2\x89\x04\xb1,\x91\xc4\xb5\xfd"\xd8\x9d\xa39@\x84-(\x03\xce\xb1g\xd4\nXS\xad \x14\xa5D\x8e\x06\x8e\xf754>\xbe\x82(\xc9\xf8\xc9\t\xb3\nSV:p~g\xac\x07\x15v?\x1c\xbe&31+P"XP\x0e\xc5d\x0c\xcb7\'\x92G\xda/\x8c\x9e\xc0\xcb\x07G*k\xfd\x85\xe1\x8e\'\x10\x80\x90\xc9Hj\x00<\xa1#\xe8?4\x8ev\\\xf39nX$\x93\xa6\x89\xb00R\xed\x9a\xd0\xcf\x18\x05B7\x12\x9dT\xa5\x01\xcc7\xdd\xe1\x9e\xc2\xc7\x0c\xc1\n\xd1\x94\x1fV\xfd\xfeP\xb7i-\x94\x85\x8f\x85\x98{\xfd\xe3\x19\xe9 \x85\xa3\xe1\xfa\x1av\xbctuRY\xf4\x95\xd3;M\x9f\x88)PB\x81)q\x99\xae\xcapOg\x86+\xc6:i\xff\x00\xd6@\'B\xd4~\x95\xf6\x8eWf\xedP\xd9\x8e\xa0\x03\xc8\xfe\x08\x7f\xb3V\x93\x98\x7fQc\xff\x00c\xf3\xfaG,\xa3O%b\xfe\x8fv\x86\x07\xc3\x9a\x89\xc8\xddsP\r\x89\xabt\xbd#\xa9\xc5J\x13\x10\x85\x91\xa1r\x00sf\xacs\xd8\x99\x9b\xa9A\xa9F\xe9\xe6\x97pz\x88|\x85\xa4J\x01cv\x95\xd3\xbcI\xdd\xa0O\x11g\x92\n\xd22$\xe5\x04\xb6k\xb2_x\xbf\xfc_\xd2\x05\x13\x92\x95\x0c\x8a,\xc4\x0e\x0c\xe3S\xd5\xe3I\xf8\xa2\x96\x15m\x03S\x86\xb7\xa7\xce\x14/2VC\xe8\xc0\xbd\xc5\xc7\xa31\xe9\x1dQ\x8d\xac\x9cR\x96Cq\xf8\x80&"\xb5.*\x93\xf1\x04\xdc\xf1\x86Xl\x82\xe0Pqs\x94T\xfa\xd1\x9a\x12\xe1\xe4\x85OJ\x94\xa52C\x82K\xb94\x00p\xa8p\xdfX*l\xe5%\n\xcb\x989\x16\x0ex\x81P@\xe6`J\t\xd2A\xefA\xc8\xc4\x04\x93\xb8\x96 \x9d\xd2I7!\xc1\x00\x03KV\xd1\x84\xdcRXfJ\x94\xa4\xb3)\xe9\xa0\xea=\xf5\xee\x9f\x1a\xb5\x92\xcb\x98Bj\xc1\xb2\xd1T\xcaX\xd81\x1cj#\x19x\xe3/\xf9r\xcep\x1c\x87w\xcaH\t&\xbc@7\x8aG\x8cW1\xa7\x8a\\L\x0b9T2\xa9\xcb\xee\x1a\x1d\x1d\xd2\xe95\xd3\x8chV\n\x94K\x82\x00s\xc9)\tbz\x84\x9e\x86\x07T\xd1\xe1\x92\xdeg\x008%\xaa\x1c\x06\xe8\xdd#\x15\xe2Y \x05U\xd8\x90\xa6`\x05\xc8:\xe5#\xab\xc0\xab3x\t\xc3\xce\xca\x90\x14\x02\x85B\x92H\xcc\x183]\x8d\x1b\xd6\x13c\x17\xe22\x95\xe6Pr]\xf7F\xeb\x9evI\xe6\x0f\x1a\xdb\x135y\x00Mj\xfe`\x0b*\xe6\xa5\xde\xc5\xb87\x18\x0bzX\xcd\x95E%\xc1\x15\t.\x96<jG.t\xb4:T\xec\x1e\x05J\x96\xee\xca,\x12\x0b(\x9e \x03Z\x80\xeci\xa4l\x95\xe6IRU\xe5 \x15\n3\xd0.\xb5j$3|1\xe6\r9\xe5\x92\xfa\x00\xaa\xb0)\x1a\x8e\x9a\xf5\xed\x1b\x8cze\x82\xa9r\x81J\x80\x19\x82\x94\x92H\xfe\x90\x93z\x9dH\xe1\x19\xbf\x02\x90\x07\xea\xa6j\x94(\xear\x8a\xc7\xb1E/>\xf1YC\xfc7f\xa5\xc1\xd5\x9f\xbcH=P-\x98\xe0\xf0\x80K*\xa3\x0e\xa0\xb9{5t\xbc\r\x88\x05.+r\x0b\xd7_\xda\x1a\xa1`\xcb\xb0\xa9\x00\x12\x1f\x8b7\x03rN\x94\x858\xa5\xba\x8f]c\'vf\xa8\xc3\xc3k^\n@\xa3\x80>\x7f\x86\x07Z\x8d\x05\xfe\xd0d\xb5\x86\x07(kj\xcf\xa0\xbd\xe0\xb3\x1eK\x9f\x96\xb4\xaf\xaca\x8aRhT\xa7&\xac\x05\x07\n\xbd\xf94\x0e\xb9\xeem\xf9\xda1\xcf\x99L4w\xec\t\xbf@\x7f\x08\x82\x97\xd8o\x03D\xe1\x92\xa0BE\x83\xfd\xe16\xd3\x9ae\x84\x1bfS\x82\xdf\x08\xd7\x96\xa3\xfcL\x19\x83\xc4)&\x95\x80\xf6\xf6)+\x98\x85\x04\xe6NT\xe6\xe4\x1c\x86A4\x05\x92K\xf3\xe5\x020}\xa9\x86-40\xc5\xc8R\xb2\xac\xa9^p\x86z6L\xc3\xb8o\xfbC\tS\x19$p\xf9\x7f\xa8\x18\xa9!\x12\xd2\x0e`\x01/J\x92\x94\xa4\x7f\xf9\xbcY(,\xf44\xe2\x0cKh\xe9r^\x1a\x8cR\xbf\xa9D\x0f\x85\xcbV\xfd#9S\xb7\x88\'\xf7\xe9\x18\xa1D\x92\x18\xd7\xd0=\xab\x1b\xee\xa4\xe6)r\xa22\x93~\xb9[\x94&,\x9c\xb2i\x88\x99\x94>Z\x1c\xacHe\'Q\x94\xf1\xff\x00zFY\x8c\xd5\'\xe1H\xa9\xe8*\xae\xc3\xf2\xf1\xa2\x16\x85\xcb%NH$\x0e\x0fw\xec)\xce\x17!l\xe8\xf8\x96\xcf\xfd\xa9\xbd}\x8f\xa7\x184<\x1aZ7^\x14\xad\xd4h\x96\xa7G\xa0\xe8\xf0.\x16FU\x14\x9a\x05\x1f\x91j\x7f\x8b\xc3i\x93\x92\x123\x16B\x05\xb5&\xc1\xfbV\x15\xcd\xc4\t\x85\x90\r\x19\xec\xe1&\x9d`+\xd1Ll\x13\x15,)d\n\x82\x03\x7f\xd9\x9b\xb0\x8f0\xf2\x8eR\xfa\x07\xed\xaf\xb3\xc6\xb3\xe5\x94,L\t\xa2\x00F^L\xc9W\xa1Q\x83\x93(0Rj\ni\xcf\x87\xdb\xd6(\xdd!v\xc43\xd1\x91o\xa1\x0czq\xfa\xc3\xbd\x8d4\x83\xd9\xfd?>p*\xe5f@\x07BS\xf3o\x94W\x02\x95$\xb6\xa0\xd3\xb4,\xe4\xa5\x13G\x0c\xeaD\xdc\xcbAz(\x11\xde\x86:D\xad\xa5\xb8\xd3\xf3\xd69\x16\xcb\xe1\x9f\x84;\xc3\xa4b\xf3KW\x86]I\xa1\xd1\xc3\x03N`\x11\x1c\x89vi\xa1\xe6\xd7V\x8f\x02\xdb}Cq\xc1\x0bQ\xa8k\'\xda\xdd8\xc0r\xf1\x19\xa6\xbf\x9bu%\xc84IR\x9e\x8f\xc8p\xd6\x91E\x90\xa4(\x01u\x0c\xd5\xa9\x15O{\xd0r\x81p\xd2\x12\xa2\xa7Q\x00%)\xe0H\x01J\x00\x1e\xa4i\xc2=\x08\x9e{\x1b)a\x132\x00%\xa4\x86RP\xc7\x8d\xd2nw\x93\xd5\xaf\x1b\xe2\'\tm\x99\x92\x82\xd9VTH\'\xe1cf4=\xf9\xc0SV3fgz\x12\xaf1j\x8a\xb7\xacW\x10\xb4\xab*T\n\xd2\x83\x99\x8e\xfb\x1a9g$\n\x90\xd5jY\xea\x1cPn\xcd\xf1$\x92H\x0e\x94\xdc\xe9\xa0!\xfa\xc0\x8b%J\t \xe6\rB\xc1 \x06\x04\xfa\x17\xed\x15&\xa1D\x02\xa0j\xfa\x1b\x06\x0c\xdcI\x7f\xea\x81\x96\xb2S\x98\xa9\xc5\x98\x17\xbb\xde\x94U\xab\x06)\xa33\xc4\x15&\x8a&\x84\x92\xcc\xd5\xca\x03{\xb7^q\xbc\xdcP\xf2\x11\xbc\xa0\xc3F\xaf\x98\xf2\xb8\xef\x03b\xe60\xd08\x1a=\x18\n\xd2\xf4\x15\xd6\x9c\xa3\x1c,\xc0\xa5\x87e\x1f\x89\xc6\x89ri`\x187Hj\xf4S\xdcD\xd2\xf5n.i\xc7\xd8\xbfX\x17\x0b?\xf9\x99C:\x8eP\xd4\xbf\xf5\x1f\xf5\x17\x99-jNfz\xb9j\x91J\xb8\xadmx\xf6N\xce`\x16\x90J\x8b\x8b\xd6\xaew\x9a\xa0\x01v\xbbw\x86\xc1\x90Q\xc6%D\x00TA,\xe7Sw\x0ffb+\x1eb@[$\x1d\xe1J=\x1f\x9bV\xcc\xec}k\x00#\x08\xa7\xcb\xcch\xc5\x81\x0e\x18w\x8d\xd0\xb2]@05=\xebH=\x17\x86\xb3\xd4\xe0\xd5\xa2\xa9\xcd(\xfa\xaa$\x06\xb3,\x1b\x03\xd9Q#ua\xb3\xa5\x99\x8a\x1e\x1e^"\x9c\x985}m\x08\x96\x9a\xc6~>QSN\x10v\x18\x05$\x1b\xc4\x92\xa1\x9er\x03>\x9cZ)\xe20\xa1\xa7\xe7;\xc1[QaT`>\xf1\x96\nRX\x95S\x87\xb7\xef\x0e\xb2\x85`\xe8\x96I*\x1aW\xdd\xbe\xb1L\x1c\x9c\xa4\xadW4H\xe5\xcf\xdb\xff\x00\x13\x0c\x10\x80\x10\xb1R\x14E>#P\x00\x1e\xaf\xda\x06\xc4\xcbPV\xf5\\\x9bZ\x944\xd0\x0bv\xeb\x08\xdf\x83x\x1d\x87\x92>\x03\x99_\x12E\xf2\x9d\x13\xcc\\\x8b\xb0\xeb\x08v\xac\xb5d\x96[(\xdet\x96\r\xbe\xba\xd4\xd3\xcc\xde\x9c!\xb6\x17\x16\xa9m\x90\x90A\xcd\xfeN\xe0\x9fH\x03hl\xf5\xa9)ZR\ns\xa8(\x03\xfdY]\x873\x98\xf2"\x1b\x8dS\xcb\nx\xa4{\x84^d\xa4\x0be\x8e\x83\nBR\x9a\x03\xa0\x05\xaf\xcf\xf7\xa4#\xd8\xb8E&\x85\x8b\x1a1\xb8\xe2\xd7\x10\xe2c\x05\x0c\xa2\xe1\x98\xd4oV\x84\xea\x00\x89\xb4\x93\xa4R\xd5\x07\x89d\x05)Gt\xa4\xb8\xa1\xccy\x91\xa8w\xa0\x84\xc1.@R\x95q\xe8,\xd4\xa0\xd3Wh\xd5+r\x1fM\xe2\xf6b\x06\x91\xac\xd4\x06p\x1dL\xceu\xbd\x1f\x99>\xc2\x15$\xae\xc4\x93z.\x8c\xa9J\xa8\xe0)\xce\x96zR\xc2\xa9\xd2\x16N\x91\xbc\xb9\x89!\x98\xa8\x8a\xbaJRI\r\xcd\x9c\x1el\xf0r\xf1@\x85$qzSW=\xa0%fB\x81Pa\x9c\x03\xc0\xa5\x8epG\x02\r\xb5\xef\r\x05\xe9\xbb\t\xf6\x94\xf5L\xca\x94\xd4\x06\x0c8\x9a\xe9\xc9\xfd\x0c\x15\xb3\xd4\x12\xa4/P\x08\xea\x08\xb1\x1a\x8b\x98\xf5\t@\xcc\xb0\x94\x8d\xec\xb9A%\x94\x92\xc4^\xc2\xee\x08\xa1\xadDi,\x7f4\x14\xa5\xc1U\x9d\xaex\x17\x7fQ\x15uT4e\xe8\xd2|\xc4\xa6R\x96\xce\x12\xc9#\x8b\x9e=#\xcc#\x04\x84\x8a\xa5\xf3\'\xfe&\xad\xd9\x8c\x036a\xf0\xd5-C\xe2\xafP\xff\x00h\xf3fL!,t\xa0\xed\x1c\xf2\x8e\x19e \xc4\xc8\x04\x11\xa5\x08\xea?\xd4f\x90\xca\xcd\xaf\xe3\xc6\xa8\x9a\xcd\xf9x\x17\x10\xac\xaa\x00\x87{s\xfc\xacMq\xf6\x16\xdbCD\xcf\x05-\xa4L)9\x969\x05\x0ew\x1f$\xfb@\xf8F6!\xf8\x1a8\xe4m\x0fv|\x90\x99\x82\x97\x96\\\x1d@R^\xbd\x16\xaa\xc6\xe3\x8cah\\\xd6Es\xdc\xa77\x96\xb9m\xa5}\x1c\x8b\xfe\xed\x8e\x19y\x12\xb5\x11\x98\x12i\xd8\x00\x03\xea\xe3\xb1nq\xd2)\':\x82\xc2J\x9dNM\x1d\x98\xb06\xa9c\xa6\x90\x8eF#\xc4Be\x80\xc3\xc4\\\xc2X\x1d\xd0\xa7\x17\xd71N\xbaq\x11\xd1\x17d\x19\xec\xa5P8\x1b\xd5\xa7\xc2m\x12x\xca\x12\x03ok\xd1L\xcf\xaa@oW\x868u\x82\xc2\xa1&\xc736W \xa4P\xd5\xa3\xccn$\xa1;\xaa\x0b$\xb2]\xca\x8a\x8bR\xa5\x9a\x86\xadJ\xd5\xa9\x01I\xd8\x12B\xe4\xa1g\xf9uI:\x82C%\x9c\x15\n\x02_0\x07\xe8#Yxa.\xaaJV\x96)\x14%N\x08?\t\xa1\xd2\xb5.i\x1a\x94\x7f,!D\x15\x97R\x94\\T2E\x06\x82\x80$\xbe\x82-:p\n\x04;e\x0e\xe1\xa9\xd7\xad8\xf1\x82\x99\x98\xab\x17\x85Q\n\x98\xa0J\xb4\x00\xb8\x0e\x0e\xf1\xe2\xc7\x9e\x97\xd6=\xd9\xd8p3.\xe9\tm\xd2\xc0\x95n\xd3\x81\xbd\xb4\xa8\x87\xd2\xc4\xb2\x19N\x12\xc0\xef\x00C\xe5cFz\x97\xa3\xf0\x8fQ&ZA\t\x00\x86v \x87#Vm([\x94\x15?\xb3P\x88\xc9Z|\xaeT@7\xb14\x0c\xe7\x82MO\x03\x05\xca\x9e\xa9id:\xaa\xefL\xc3M5\x06\x87\xa8\x8d\x96\xb0\xe9\x0e\x9a5\x03P\xb5X\x01Q[\xf7\xd6<S8 \x83\x98\xef\xe8\xe97\x0e4oz\xdcA\xde\xc0\t5\t\tL\xc5\x87,\x0f\x07\xff\x00\x8bP\xda\xb4\xd0A\xfb3\r(f\x96\xb5\x11\x99$\x14\xa8\x06\x05\xc1PI\xb9P\xa1\xa0\xb1cR\xd0\x1e"IyN\xa2Y\x14 3\xb2\xd6RH\xd2\x99Oq\x18\xe2\x86P\xe9\n\xf2\x96\xd4\x97\xd7\xfbRK\xda\xa77C\x0c\xf2\xa8\xc8\xc3\x13\x84\x19\xd4\xc8j\xdb0\r\xd9\xa2D\xfdZ\x93L\xd9y\x07,\xf5\xe1\xce$\x1c\x98[\x89C\x88#e.\x8d\xcd\x84b<\xa4\x1dC\x8e-\x04\xecT\x8c\xc4,\xe5\x02\xaeiV,;\x91\x13\xba+\xe1\xe6=,A\xf5\x8dd\xba\x9d9\t\xe0@\x1e\x9cX\xe9\x19\xedJ\x91W\x1d"\xb2\xb1d\x00\xca\xd0Z\xb4\x1c\x9b\xb58\xc3\'\xf4+A\x7f\xa9\xca\x1b\xfbM\xbd\x87G>\xd1\x8a\tQS\x9a2s\x00\xcen@\x03\x87\x13\xf7\x81\x118\xe6\x00\x00X\xb9p\xe1\xab\xa3s\x8f\x04\xe2\xea\xb5A~|\xff\x00h=P\x8d\x84\xceRjns{t\x82%\xed\x05!\x04\x00,\xc3\x8b\xd6\xdc!n-a$\xd7] \x1f\xd59\x02\x03\xe3U\x91\x94\x98\xceHQ.K\x12\x7f\xde\x9f\x8f\x04N]\xb3T3\x0b\x01\xc3\xacW\r4\x04\xd8r\xf6\xfb@\xd3V\t9\x8b\'\x8d\xfe\xb1)bI\x06\xef!\xf2\xd8\xa4\x93G\x14z\\V\xdc\xf4\x1c 9\xb8\x9d\x07\x02\xee\xd6j\x98\x13\x17\x8be%\x19\x9ce\x04\x11b\x1e\xed\xcf\xe8 y+%\xc0\xba\xa8\x07\xd0E:\xfd\x98l\x9cC\xb2\x81p*\xc6\xa4\x07o\xb5A\xeb\x17\x98\x910\x81\xe6!\x995\x04\xb0\x0c\xde\x9e\xcc\xd0.\x1b\n\\%\xdc\xd9\x83\x15\x02~\x8f\xe9\x16\xc2\xa9%n\x91V5.G\x94\xb33@\xaf\xa0\xaf\xd0\xc4\x01S\x96\xa6\x8a\x1fQNf\xba\xb9\xe3\x1a\x1c Q3\x12\x902\x80Ofs\xd6)"\xaa\t!\x8a\xcf1Z\x93\xf7\xe4\x1f\x84\x1a\x00\x12\xc8B\x89S\x10\xa0S\xe5%\xc0rZ\x9a\xfa\xf0\x89\xcd\xbf\x06\x8e\xc4\xd8\xf9\xebL\xcf\rc"\x9f\xcaEX\xd9\x99\xe8x\xc0\xea\x05\x0e?\xc8{\x8f\xac} bp\xf8\xb4\xa3\xc5\x90\x95\x10\x90R\xab-6*\tX\xad\xf44\x85\xbbC\xf87\xc4$\xe1\xa6\xa5T,\x89\x9b\xab\x04\xd42\xc5\x15P.\xd0\xab\x96:x-\xd1\xa5h\xe3\xf0\xeb\xce\xb6\x06\xb4#\xa8\xa9\x11\xae%\x1e!\x00\x1a\xe6%<\x9a\xff\x00(_\x8d\xd9\x98\x9c,\xcf\x0el\xb5\xa6` \xa5\xc7\x9a\xac\xe8!\xc2\xad\xa1\x8e\x8fd\x94f\x19\xd8(\x97\xd2\x80\xe8\x0b\xb5\xfd\xe9\x14\x92\xeb\xa1T\xd3:/\xe1m\x8f-I\x19\xc5u\r\xac0\xdb\xfb/(I\x96\x9d\xe4\xa5i\xea\x96\x0b-K\x80\x857H\xdfexiPHt\xad\xd9MF\xd2\xaf\xaf(s\xb4\x12\xcb\x96^\x81cW\xf3\xa5r\xfek\x11\xc6\xdb\xede\xe4\x93T|\xbef\',\xb2\xb0H+O\x88\x0f\xa8P\x06\xe2\xa9:\xd5\xfb\xc0\xf8E\xa4\x02\xc9$ %5v\xa0~\x95*\xee\xdc \xdf\xe2\xcc\x11\x935H%\x90\x80T4\xddR\xb3\xa1,\x19\xd2\t#\xd2\x13`$-\x83\x92,\xbelC\xb3\xbfM#\xb5+M\x9c3\xc6\x0e\x85\x02\x81E@\x12m\xd0\\\xb5\x81\xde\xf4\x10,\x89\xae\xac\xe5\x88\x07v\x94j\xa8\xa8\xdd\xdc\x8ar\x03\x9c\x0eg\x92\xa0\x82\xfb\xc9 \xa7\\\x8a\x0c\xc0\x8b\x13j\xf1&\t(*)J\x89\t\x0e\xa2\xc2\xc1\x83\x00m\xa6\xb7&\x02\x8f\xd8\xa6\xe9\xc4\xa1N\xa0\x92A!>\xae\xd9I{\n\x0eO\x03\x95\xa4\x1a\x02\xe4\x96\xe6\xc7W\xe2r\xd2<a\xe20\xa0\xf2\xcb\x04\x82\x05C\x96\t\xbeQ\xec8\x06\xceZ\x82IBs+(.^\xdb\xad\x956\xde/z\x0fx\xd4\x91\xb6\x1f!\x92(\\\x86\x15b\tz\x92\xf4\xe7\xc6\x04\x98\xa5(\xeeynE\xb2\xd4\x03\xa3\x9aP\x0e\xd1\xe1\x94s\x8c\xa8\xcc\x01\x01\x94\xc1\xc3\x13\xe8\xf7\xe8i\x0c$\xd1a\x88\x19t\x07\xab\x02xT\x1b\xf2\x80\xe4\x90\xc9Y\xe4\xbc\x02\xcaAHr.\x1d\x9a\xac3$\xf0:\xc0\x82p\x96JK\x95\x07\xderY&\x8e\xdd\x1f\xef\x06b\x10\x14FP\xcaM]%\x89f\xb2\x86\x8e]\xcbZ\xb0\xbc(\xa8\xef\xdc(\xde\xae\xdc8\xdc\x9f\xb4\x18\xca\xd6M(\xd0A\x00\xcbB\x94\x1c\x82r\xa4\xb8\x01ON\xb5s\xed\xa4c2^f\x076\xff\x00\x98\x8f\xe9\xd7Zv\xe1\x07H\xc2\x95\xa6\x99\x94\x92\x97\xd4Q\x89\xb7r\x07Q\xc4E\x96\x06\xeb\x10\x16\x92\xf6\x15P\xa8\x1a\xd9\xcf\x0evx*\x7f@\xa1>F\xa0b\x05\x9c\x17\xef\x1e\xc1sq8\x92I\xceC\xd7x\xa8\x1e\xf1\xec\x1e\xd2\x06\x0enV  \xe75"\xdfs\xed\x19H\xc4o\x13w\xe7\xeb\x18\xe2e\x92\x0ca\x80\x92\xa2XC$\xa8.\xd8\xc9s\x9e\x91U\xca\xf8\xbf\x1a\xa1\xfd\xe0Ld\xb2\x95ewm`\xcc4\xc2\xa4\xda\xba\xc3:K\x06\x8ep\xc8V\x12\xeeN\x9a}t\x8a\xcd\x9a\xe41&\x965W\xdd\xa2\x93\xe5\xb3\x97#\xf3Q\x0b\x17\x8b.\xe1JaGK\x8e \xf3\x83\x18\xb6(T\xe5\x82\x03\x17$\xfe\xdf8\x1b+\x17\x8fe\xce\n\xb8e\x02]\x86P\xab\xd4\x01\xad\xb9E\xc2a\xbd\xc9\x9a\x18\xc8\x9a\xe9\xedn\xed\x1e\xe3\x96\xf4\x15Q:\x07\xa9\x0e\xfd\x03\xb7h\xae\x01\n.\x12\xce@\x01\xf4r3\x1e\xc0\x13\xd8\xc7\xb3\xb0\xceTH)H\xf2\x0f\x85\x81\xa3\x90\xfaU\xfaDe\x04\xe5c\xc7D\xc4a\xd2\x19\xee\x97\r}}\xf5\xf5\xf5\xd2R\x1c=\xb8\xe9\xda\x02\x98w\x90\xe9\xa1\x1aY\x9fB8A\xa8Y\x08*I!\x00\xb0<z\x8fS\xda\x04\x93X\t\x8a\xe7\xaf2\x99\x80K)\x9c\n[\xea\x1b\xa4\x1c\xbc\xe8Nbo@\x0b\x07*\x17\xd2\xd7=\x0f\'\xc3\x0e\x92\xa5X\x00iNz\x0eV\x86X\xf9t\n\xca\t"\x80\xb9\x19\xbe\xe6\x9e\xd6\x85\x97"\x8bI\x86)\xb0<$\xbf1\xca|\xc5%D\x05\x02h\x00\x02\x955\xe6+\xd2\x0f\x96]a\x8eb\x9a\x12I\xcaE]%G\x96\xbap5q\x80\xce\xa1\x94\x82\xa4\x82\x01\xa8,nEE\x08 q\xa0\x8b/\x0e\xa4\xa5\x132\xb2\x92R\xec\x02\xa9k\x93\xc9\x8fQ\x05\xab7j\x1dl\xb9\xa4\xac\xa0\x13C\xe5Q\x0e\x97$\x97"\xec\xe6\xda\x11\xc4GG\x85B\x08Ir\xea\xa8\xe6\xfa\xbf\xac|\xf6F!i\x99\xe1\xa5!\x82*-\xa2\xb3$\xea\xdb\xa2\xd6,c\xaa\xc1b\x14\x99\x88\x96\tPT\xb0AwND\x92\x9b\x87foF\xa4K\x92\x15\xb2\xbc|\x99:M\xa7\x81N*NI\x8a\xca\xb4>E\xdc\xa4\xea\x0f\x14\x9a8\xe48G\x07/cN\xc3\x13.d\xa0R\xee\x92\x1d`\x9b\x9c\xaa\x15\xd2\xcc\x9b\x02y\xf5\xb8\x9c`\x97\xb8\x92\t*\xf3^\x8c\x1e\xbc\xdcS\x8c\x0e\xbcg\xf3\x04\xb5\x9c\xd2\x9by\n\xb2\x94w@<\xd8\xa8\xb7 od\x8c\x9cUx<\x94[\xb1f\x03iKL\xc4$\x90\x97XI\x14\xa1$\xb5E\r\x1a\x9a8x\xec6\x8e$\r\r\nW\xdaZ\xd2\xbf\xfdc\x95\xc6\xff\x00\x0f\xcb\xcc\x12W\x92P_\xc6P\xa5\x02\x95$\xe5J\x89|\xad\xad\xfc\xa7G7\xc7c\xc9\x9b3x\x10\xb4\x9c\xafT\xe4P\xa3\xb5I \xb0b\x0f8\x1c\x89J\x9c@\xa4\xd5\xd9\xb7\xff\x00\xd0\xf0bvU"\x84+\xc3Y9\xb2\x80\xa2B\x1d\x85\x87\x86z<rX\xfc\xf2\xd4\x945>%y\x93@\xcd\x98R\xc0\xd2\xb6\x0f\x1dF/\x10\xb9\xa8R\xc1\xde+\xcc\xa4\xf0,\x123\x11q_\x9f\x178\xe16?\xf3\x16\x14J\x93\x98-n\x12\xa49\xcc\xb1\x96\xae\x00S-\xbf\xb4\xff\x00T[\x8et\xa9\x90\x9c{<\x08\xb0\xf2\x88HY\x04\x95\x17\xa0\x16\x1a\x16\xa55f.\xfc`\xec\n\xcdBhT\x96\x05V\x1a\xb1<KY\x8f\xb41\x99\x83R\x80\x08I\x08;\xc1\xb3\x07\xaa\x94H\xe7{j\x96b\xf5\xf2L\x84\'6t\n+2\x88\x0e\xb2\xa0]$\x96d\x80\xf4\xf990\xaf\x92\xcc\xa3@\xc1.\xc1$%$\x97\xa6\x85\x83\x83\xea\xe1\x83\xfaF\xc9\xc0\x00\xeb5S\n\xa48Q\x0c\x1c5\xc9\x0c9|\xb6t\x9d\xe4$e\xb8\x049\xa5K\x01F\xa1\x85\xc7i\x02\x19\xcd\xc3&\x89O\x98\x80\x1a\xcd\x99\x87xO\x94\x8dK\xd3y\x92\x94\x958\xad\nFg\x14!\x94\xedj\x125>\xb1D\x00\x16M\x89`\xf7\x0e\xdb\xb6\xad\x80\xb5Z3\xc4\xccZ\\\x84\x82r\xdd\xea\xd5g6\x04\x15\x07\xae\x9c\xa0\x0f\x18\x859N\xf0v&\xb9\x8b\x1a\x92\xecM\x1f\xa0\x83\xd5\xb0\xe0g\xe2\xccJ\xf2\xa5\x1d\xf4\xa8\x0e\\\xd3\x81m\x05\xa2\xcaYY\tR@\xe0Hb\\0\xad@\xa5\xcbXV\x16I\x9e\x1e\xa0\x12~.z\xd0\xfeV5YP\xcc\xc0=\x1cj\x12*kk\xfc\xa1\xea\x81cl~0Q\t$$\x00\xe36`C\x95\x0e\xc0\x85P\x9a\xbe\x96\x85\xb8\x89\x8d\xbc\xe1@\x90\x1c\xfb\xb0\x11\x89\x92I\xcc\x14\x14\x92N\xb7s\xc0X\xbd \xb0\xd9F\xeb\x00\t\x040\x06\x84\x80X\x03\xa0:\x08\t(\x9aY\x05\xfdI\x1eQ\xbb\xa3;7\'\x11"~\xa9"\x9b\xe3\x96\xf1g\xaf\x18\x91[BS9\xe9\xa3q\xe0\x1d\x9f8\x15\x90h\r"D\x8aGL`\xbcR\xd9"\xccmJ\xc7\xb8K^$H(\x01r\xc1Y\xc8\x82A:\xbb|\xa0\\v\x0b\xf9bb\x96Eh[x\xd5\x83\x14\xd807\xe5\x12$2\x14[\x95F\xa4\xda\x83\x9e\x84\x9e\xe25\x96\xb2\xab\xe8\xc3\xe6#\xc8\x91\x98F{5J\x05L\x01w@\xad\x83V\x9a\xbb\x81\xeb\x1a!E\x95,\x17M+\xa9#\x9d\xd8\xbcH\x9160N\xcd\x90\x95 \x12\n\x86j\xb9!\xc5x\x1e@w\x8b\xaezR\xbc\x80$$\x02K$\xdc\x8b\x87\xe0\xc3\x8e\xbcbD\x8c\xc0VT\x95\x1f+f\x1e\x86\x18a\x87\x88\xe8\xab\x86\x15fz8\xd6\x95\x1fx\x91"R\x82mXn\x91\x820\xb9K\x86`(E\xdc\x9a;\xd5\x83\x1fht\xa3)*Y\x00\x91\x94$%\xd9!-\x99@\xd1\xc9\xcc\x908o\x1e\xb1"C0##\x83\x94B\x94K\x13\xc4\x1a\x17\xb3\x87z\xbdx\x11}\r\x9b\x8bJP\x9c\x8ar\xaf\xe5\xb9\x043\x92[\x9e\xb5`\xdd\xe2D\x89\xbc\x8c\x8c\x13\x89\xf1\x14\xc2\xc3R*\xda\x8e,H\x1c\xe0\xc0\x80\x94\xaah!6&\x8e7\xf3U\x87\xfc\x05\x1bQ\xdb\xc8\x90\xb2KCE\xe0\x1b\x11\x8e\x96\xa4\x14\x80T\x92B\x8d\x07\x9c\x10\x12]U\xa8Yv\xd0\xb3p\tj\xac\xc5\x17\x00\xa5@9t\xa7p;\x91\xbch\x1a\x83N\x91\xecHh\xa5B\xb6IIR2\xac\x10\xc6\xa8,\x0e`\xe0k`\xcc*4\xa80\xee^7$\xb5p)up|\xb6\t\xe0\xcc\xd1\xe4H\xd2\xd8"\r7\x1b\x99(\x02\xf9\x02^\xc0\xd4\xabxj]]=\xe1V"l\xc1\x94g$*\x81\'_\xe9\x07F\xd3\xd2=\x89\x0b\x14\xbb\x0c\x05\x8a[\xa0\x84\xb9QmXW@xu\xe5\x03e)\xddO\x98!\xb9\xfc*a\xa5BK\xbf\x16\x89\x12*\x85\x96\xc9"Z\x94\x90\x11`\t\x01\xf9\xda\xbc\xc7\xb9\x83qR\x12\xea\xf3\x02\x95\x00\xba\x803(\x00H`i\x9b\x95\xc9\xd2$H\xcff`X\x84\x80\xa0\x96\xcahs\x02h\xec*5\xd0\xd0\xc7\x82XK\xb9|\xbb\xda\xf2\xb5u\x89\x12\x0f\x82\xfa\x1b7\x14<$\x13a[\x97\xab\xe5\x7fW\xd7\xb6\xb6\x18\xb23&Y\xa0,\xdcs\x1c\xa0WP\xf7\xe7\x12$\'\x83\x02\xcc5;\xa9\xf7\x89\x12$8\xa7\xff\xd9'


@pytest.fixture
def mock_cloud_storage_client(
    mocker,
    attachment_file_blob,
):
    mock_client = mocker.MagicMock()
    mock_client.download.return_value = async_return(attachment_file_blob)
    mock_client.__aenter__.return_value = mock_client
    mock_client.__aexit__.return_value = None
    return mock_client


@pytest.fixture
def mock_cloud_storage_client_class(mocker, mock_cloud_storage_client):
    mock_cloud_storage_client_class = mocker.MagicMock()
    mock_cloud_storage_client_class.return_value = mock_cloud_storage_client
    return mock_cloud_storage_client_class


@pytest.fixture
def mock_smartclient(
    mocker,
    smartclient_post_smart_request_response,
):
    mock_client = mocker.MagicMock()
    mock_client.post_smart_request.return_value = async_return(
        smartclient_post_smart_request_response
    )
    mock_client.__aenter__.return_value = mock_client
    mock_client.__aexit__.return_value = None
    return mock_client


@pytest.fixture
def mock_smartclient_with_400_response(
    mocker,
):
    mock_client = mocker.MagicMock()
    error = SMARTClientException(
        "SMART request failed for https://fakesmartconnectsite.smartconservationtools.org/server/api/data/4b23242a-1161-46c3-af84-5e35dc801c43 with response code 400"
    )
    mock_client.post_smart_request.side_effect = error
    mock_client.__aenter__.return_value = mock_client
    mock_client.__aexit__.return_value = None
    return mock_client


@pytest.fixture
def mock_smartclient_class(mocker, mock_smartclient):
    mock_smartclient_class = mocker.MagicMock()
    mock_smartclient_class.return_value = mock_smartclient
    return mock_smartclient_class


@pytest.fixture
def mock_smartclient_class_with_400_response(
    mocker, mock_smartclient_with_400_response
):
    mock_smartclient_class = mocker.MagicMock()
    mock_smartclient_class.return_value = mock_smartclient_with_400_response
    return mock_smartclient_class


@pytest.fixture
def smart_integration_v2():
    return schemas_v2.Integration.parse_obj(
        {
            "id": "b42c9205-5228-49e0-a75b-ebe5b6a9f78e",
            "name": "Gundi Test CA - SMART Connect",
            "type": {
                "id": "265922fa-4682-4157-a055-d3ce3f12eea3",
                "name": "SMART Connect",
                "value": "smart_connect",
                "description": "",
                "actions": [
                    {
                        "id": "b0a0e7ed-d668-41b5-96d2-397f026c4ecb",
                        "type": "auth",
                        "name": "Authenticate",
                        "value": "auth",
                        "description": "Authenticate against smart",
                        "action_schema": {
                            "type": "object",
                            "title": "SMARTAuthActionConfig",
                            "required": ["login", "password"],
                            "properties": {
                                "login": {"type": "string", "title": "Login"},
                                "endpoint": {"type": "string", "title": "Endpoint"},
                                "password": {"type": "string", "title": "Password"},
                            },
                        },
                    },
                    {
                        "id": "ebe72917-c112-4064-9f38-707bbd14a50f",
                        "type": "push",
                        "name": "Push Events",
                        "value": "push_events",
                        "description": "Send Events to SMART Connect (a.k.a Incidents or waypoints)",
                        "action_schema": {
                            "type": "object",
                            "title": "SMARTPushEventActionConfig",
                            "properties": {
                                "ca_uuid": {
                                    "type": "string",
                                    "title": "Ca Uuid",
                                    "format": "uuid",
                                },
                                "version": {"type": "string", "title": "Version"},
                                "ca_uuids": {
                                    "type": "array",
                                    "items": {"type": "string", "format": "uuid"},
                                    "title": "Ca Uuids",
                                },
                                "transformation_rules": {
                                    "$ref": "#/definitions/TransformationRules"
                                },
                                "configurable_models_lists": {
                                    "type": "object",
                                    "title": "Configurable Models Lists",
                                },
                                "configurable_models_enabled": {
                                    "type": "array",
                                    "items": {"type": "string", "format": "uuid"},
                                    "title": "Configurable Models Enabled",
                                },
                            },
                            "definitions": {
                                "OptionMap": {
                                    "type": "object",
                                    "title": "OptionMap",
                                    "required": ["from_key", "to_key"],
                                    "properties": {
                                        "to_key": {"type": "string", "title": "To Key"},
                                        "from_key": {
                                            "type": "string",
                                            "title": "From Key",
                                        },
                                    },
                                },
                                "CategoryPair": {
                                    "type": "object",
                                    "title": "CategoryPair",
                                    "required": ["event_type", "category_path"],
                                    "properties": {
                                        "event_type": {
                                            "type": "string",
                                            "title": "Event Type",
                                        },
                                        "category_path": {
                                            "type": "string",
                                            "title": "Category Path",
                                        },
                                    },
                                },
                                "AttributeMapper": {
                                    "type": "object",
                                    "title": "AttributeMapper",
                                    "required": ["from_key", "to_key"],
                                    "properties": {
                                        "type": {
                                            "type": "string",
                                            "title": "Type",
                                            "default": "string",
                                        },
                                        "to_key": {"type": "string", "title": "To Key"},
                                        "from_key": {
                                            "type": "string",
                                            "title": "From Key",
                                        },
                                        "event_types": {
                                            "type": "array",
                                            "items": {"type": "string"},
                                            "title": "Event Types",
                                        },
                                        "options_map": {
                                            "type": "array",
                                            "items": {
                                                "$ref": "#/definitions/OptionMap"
                                            },
                                            "title": "Options Map",
                                        },
                                        "default_option": {
                                            "type": "string",
                                            "title": "Default Option",
                                        },
                                    },
                                },
                                "TransformationRules": {
                                    "type": "object",
                                    "title": "TransformationRules",
                                    "properties": {
                                        "category_map": {
                                            "type": "array",
                                            "items": {
                                                "$ref": "#/definitions/CategoryPair"
                                            },
                                            "title": "Category Map",
                                            "default": [],
                                        },
                                        "attribute_map": {
                                            "type": "array",
                                            "items": {
                                                "$ref": "#/definitions/AttributeMapper"
                                            },
                                            "title": "Attribute Map",
                                            "default": [],
                                        },
                                    },
                                },
                            },
                        },
                    },
                ],
            },
            "base_url": "https://fakesmartconnectsite.smartconservationtools.org",
            "enabled": True,
            "owner": {
                "id": "a91b400b-482a-4546-8fcb-ee42b01deeb6",
                "name": "Test Org",
                "description": "",
            },
            "configurations": [
                {
                    "id": "abce8c67-a74c-46fd-b5c3-62a7b76f2b17",
                    "integration": "b42c9205-5228-49e0-a75b-ebe5b6a9f78e",
                    "action": {
                        "id": "b0a0e7ed-d668-41b5-96d2-397f026c4ecb",
                        "type": "auth",
                        "name": "Authenticate",
                        "value": "auth",
                    },
                    "data": {
                        "login": "fake-username",
                        "password": "fake-password",  # pragma: allowlist secret
                    },
                },
                {
                    "id": "55760315-3d68-4925-bf2d-c4d39de433c9",
                    "integration": "b42c9205-5228-49e0-a75b-ebe5b6a9f78e",
                    "action": {
                        "id": "ebe72917-c112-4064-9f38-707bbd14a50f",
                        "type": "push",
                        "name": "Push Events",
                        "value": "push_events",
                    },
                    "data": {
                        "version": "7.5.4",
                        "ca_uuids": ["4b23242a-1161-46c3-af84-5e35dc801c43"],
                        "transformation_rules": {
                            "category_map": [],
                            "attribute_map": [],
                        },
                    },
                },
            ],
            "default_route": None,
            "additional": {
                "topic": "smart-dispatcher-topic-test",
                "broker": "gcp_pubsub",
            },
            "status": {
                "id": "mockid-b16a-4dbd-ad32-197c58aeef59",
                "is_healthy": True,
                "details": "Last observation has been delivered with success.",
                "observation_delivered_24hrs": 50231,
                "last_observation_delivered_at": "2023-03-31T11:20:00+0200",
            },
        }
    )


@pytest.fixture
def dispatched_event():
    return schemas_v2.DispatchedObservation(
        gundi_id="23ca4b15-18b6-4cf4-9da6-36dd69c6f638",
        related_to=None,
        external_id="ABC123",  # ID returned by the destination system
        data_provider_id="ddd0946d-15b0-4308-b93d-e0470b6d33b6",
        destination_id="338225f3-91f9-4fe1-b013-353a229ce504",
        delivered_at=datetime.datetime.now(),  # UTC
    )


@pytest.fixture
def observation_delivered_event(dispatched_observation):
    return system_events.ObservationDelivered(payload=dispatched_observation)
